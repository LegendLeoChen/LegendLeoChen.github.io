<!DOCTYPE html>


<html lang="zh-CN">
  

    <head>
      <meta charset="utf-8" />
        
      <meta name="description" content="一个秘密空间" />
      
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title>微信小程序知识点 |  LegendLeo Chen 的空间</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/mylogo.ico" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
<!-- 封面标闪烁 -->
<link rel="stylesheet" href="/css/zhyBlogTitle.css">
<script src="https://cdn.bootcdn.net/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<!-- jquery，懒加载、统计、说说需要的jquery -->
<script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-微信小程序知识点"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  微信小程序知识点
</h1>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/" class="article-date">
  <time datetime="2023-03-04T06:41:38.000Z" itemprop="datePublished">2023-03-04</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a> / <a class="article-category-link" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">14.8k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">57 分钟</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <h1 id="一、初识微信小程序"><a href="#一、初识微信小程序" class="headerlink" title="一、初识微信小程序"></a>一、初识微信小程序</h1><h2 id="1、什么是微信小程序"><a href="#1、什么是微信小程序" class="headerlink" title="1、什么是微信小程序"></a>1、什么是微信小程序</h2><h3 id="Ⅰ-小程序历史"><a href="#Ⅰ-小程序历史" class="headerlink" title="Ⅰ-小程序历史"></a>Ⅰ-小程序历史</h3><span id="more"></span>
<blockquote>
<ol>
<li>2017 年度百度百科十大热词之一 </li>
<li>微信小程序，简称小程序，英文名 Mini Program，是一种不需要下载安装即可使用的应用 (<code>张小龙对其的定义是无需安装,用完即走,实际上是需要安装的,只不过小程序的体积特别小,下载速度很快,用户感觉不到下载的过程</code> ) </li>
<li>小程序刚发布的时候要求压缩包的体积不能大于 1M,，否则无法通过，在2017年4月做了改进，由原来的1M提升到2M；</li>
<li>2017年1月9日0点，万众瞩目的微信第一批小程序正式低调上线。</li>
</ol>
</blockquote>
<h3 id="Ⅱ-小程序的优势"><a href="#Ⅱ-小程序的优势" class="headerlink" title="Ⅱ-小程序的优势"></a>Ⅱ-小程序的优势</h3><blockquote>
<ol>
<li>微信有海量⽤⼾，⽽且粘性很⾼，在微信⾥开发产品更容易触达⽤⼾；</li>
<li>推⼴app 或公众号的成本太⾼。 </li>
<li>开发适配成本低。</li>
<li>容易⼩规模试错，然后快速迭代。</li>
<li>跨平台。</li>
</ol>
</blockquote>
<h2 id="2、小程序准备"><a href="#2、小程序准备" class="headerlink" title="2、小程序准备"></a>2、小程序准备</h2><h3 id="Ⅰ-环境准备"><a href="#Ⅰ-环境准备" class="headerlink" title="Ⅰ-环境准备"></a>Ⅰ-环境准备</h3><blockquote>
<ol>
<li><p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html">安装微信小程序开发工具</a>,建议安装稳定版进行开发</p>
</li>
<li><p>注册小程序账号</p>
</li>
<li><p>使用注册的appid进行使用，如果是测试号会限制很多功能</p>
</li>
</ol>
<p>  在官网<a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/">登录</a>成功后可以看到下面的界面，然后复制你的APPID,悄悄的保存起来，<code>不要给别⼈看到</code>😄。<img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210420175717770.png" alt="image-20210420175717770"><img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210420175813507.png" alt="image-20210420175813507"></p>
</blockquote>
<h3 id="Ⅱ-新建小程序流程"><a href="#Ⅱ-新建小程序流程" class="headerlink" title="Ⅱ-新建小程序流程"></a>Ⅱ-新建小程序流程</h3><blockquote>
<ol>
<li><p>打开开发者工具，第一次打开需要扫码登陆</p>
</li>
<li><p>新建小程序项目</p>
</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210420180254814.png" alt="image-20210420180254814"></p>
<ol start="3">
<li>填写项目信息</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210420180344226.png" alt="image-20210420180344226"></p>
<ol start="4">
<li>新建成功</li>
</ol>
</blockquote>
<h3 id="Ⅲ-微信开发者工具介绍"><a href="#Ⅲ-微信开发者工具介绍" class="headerlink" title="Ⅲ-微信开发者工具介绍"></a>Ⅲ-微信开发者工具介绍</h3><h4 id="1）开发工具界面图解"><a href="#1）开发工具界面图解" class="headerlink" title="1）开发工具界面图解"></a>1）开发工具界面图解</h4><blockquote>
<p>详细的使⽤，可以查看<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/devtools.html">官⽹</a>:</p>
<p><img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%E8%80%85%E5%B7%A5%E5%85%B7%E6%B3%A8%E9%87%8A%E5%9B%BE.png" alt="image-20210420181145002"></p>
</blockquote>
<h4 id="2）开发工具的一些基本配置"><a href="#2）开发工具的一些基本配置" class="headerlink" title="2）开发工具的一些基本配置"></a>2）开发工具的一些基本配置</h4><blockquote>
<ol>
<li>点击<code>工具栏</code>–&gt;<code>详情</code>–&gt;<code>本地设置</code>，除了默认勾选，需要勾选其他的几个如：增强编译、不校验合法域名…</li>
</ol>
<p> <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/%E5%BE%AE%E4%BF%A1%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E7%9A%84%E8%AF%A6%E6%83%85_%E6%9C%AC%E5%9C%B0%E9%85%8D%E7%BD%AE%E6%B3%A8%E8%A7%A3%E5%9B%BE.png" alt="image-20210420183249939"></p>
<ol start="2">
<li><p>常用快捷键<code>keyMap修改</code>设置(本人习惯记录)：</p>
<ol>
<li><p><code>ctrl+P</code>：全局搜索</p>
</li>
<li><p><code>alt+/</code>or <code>shift+j</code>:代码提示</p>
<p><img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210421141701374.png" alt="image-20210421141701374"></p>
</li>
</ol>
</li>
</ol>
</blockquote>
<h3 id="Ⅳ-微信小程序名称或者原始id该如何找回？"><a href="#Ⅳ-微信小程序名称或者原始id该如何找回？" class="headerlink" title="Ⅳ-微信小程序名称或者原始id该如何找回？"></a>Ⅳ-微信小程序名称或者原始id该如何找回？</h3><blockquote>
<p>问题描述：很久没有进行开发了，小程序的名称跟原始id都忘记了，找回需要先填写,如何解决</p>
<p>解决：首先<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/community/develop/doc/000ea0f82d4f58b41589642b456809"><code>查询自己的原始id</code></a>,在这个网站能查询到自己的原始id，再通过这个原始id进行找回</p>
</blockquote>
<hr>
<h1 id="二、小程序的基本目录结构与文件作用剖析"><a href="#二、小程序的基本目录结构与文件作用剖析" class="headerlink" title="二、小程序的基本目录结构与文件作用剖析"></a>二、小程序的基本目录结构与文件作用剖析</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/MINA.html">小程序框架</a>的⽬标是通过尽可能简单、⾼效的⽅式让开发者可以在微信中开发具有原⽣APP体验的服务。 </p>
<p>⼩程序框架提供了⾃⼰的视图层描述语⾔ <code>WXML 和 WXSS</code> ，以及 JavaScript ，并<code>在视图层与逻辑层间提供了数据传输和事件系统</code>，让开发者能够专注于数据与逻辑。</p>
</blockquote>
<h2 id="1、小程序文件结构和传统web对比"><a href="#1、小程序文件结构和传统web对比" class="headerlink" title="1、小程序文件结构和传统web对比"></a>1、小程序文件结构和传统web对比</h2><blockquote>
<table>
<thead>
<tr>
<th></th>
<th>传统web</th>
<th>微信小程序</th>
</tr>
</thead>
<tbody><tr>
<td>项目骨架、结构</td>
<td>HTML</td>
<td>WXML</td>
</tr>
<tr>
<td>页面样式</td>
<td>CSS</td>
<td>WXSS</td>
</tr>
<tr>
<td>项目逻辑</td>
<td>Javascript</td>
<td>Javascript</td>
</tr>
<tr>
<td>配置</td>
<td>无</td>
<td>JSON</td>
</tr>
</tbody></table>
<ol>
<li><p>通过以上对⽐得出传统web是<code>三层结构</code>。⽽微信⼩程序是<code>四层结构</code>，多了⼀层<code>配置.json</code></p>
</li>
<li><p>当这几个文件在同一级目录下且命名相同(后缀不同),可以互相引用却不用导入</p>
</li>
</ol>
</blockquote>
<h2 id="2、基本的项目目录"><a href="#2、基本的项目目录" class="headerlink" title="2、基本的项目目录"></a>2、基本的项目目录</h2><h3 id="Ⅰ-项目目录解释"><a href="#Ⅰ-项目目录解释" class="headerlink" title="Ⅰ-项目目录解释"></a>Ⅰ-项目目录解释</h3><blockquote>
<ol>
<li>项目目录图解:</li>
</ol>
 <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/ 基本的项目目录图例.png" alt="image-20210420190111436" style="zoom: 67%;">

<ol start="2">
<li>以<code>app</code>开头的文件是应用程序级别的文件,更改一处全局生效。而页面<code>pages</code>的配置优先级高于全局配置(<code>就近原则</code>)</li>
<li>小程序是允许你修改文件目录名的</li>
</ol>
</blockquote>
<h2 id="3、小程序配置文件"><a href="#3、小程序配置文件" class="headerlink" title="3、小程序配置文件"></a>3、小程序配置文件</h2><blockquote>
<p>⼀个⼩程序应⽤程序会包括最基本的两种配置⽂件。⼀种是全局的app.json 和 ⻚⾯⾃⼰的page.json</p>
</blockquote>
<h3 id="Ⅰ-全局配置app-json"><a href="#Ⅰ-全局配置app-json" class="headerlink" title="Ⅰ-全局配置app.json"></a>Ⅰ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/config.html">全局配置app.json</a></h3><blockquote>
<ol>
<li><p><code>app.json</code> 是当前⼩程序的全局配置，包括了⼩程序的所有⻚⾯路径、界⾯表现、⽹络超时时间、底部tab等。普通快速启动项⽬⾥边的 app.json 配置</p>
</li>
<li><p>代码</p>
</li>
</ol>
<pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"pages"</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">"pages/index/index"</span><span class="token punctuation">,</span>
    <span class="token string">"pages/logs/logs"</span>
 <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">"window"</span><span class="token operator">:</span><span class="token punctuation">{</span>
    <span class="token property">"backgroundTextStyle"</span><span class="token operator">:</span><span class="token string">"light"</span><span class="token punctuation">,</span>
    <span class="token property">"navigationBarBackgroundColor"</span><span class="token operator">:</span> <span class="token string">"#fff"</span><span class="token punctuation">,</span>
    <span class="token property">"navigationBarTitleText"</span><span class="token operator">:</span> <span class="token string">"WeChat"</span><span class="token punctuation">,</span>
    <span class="token property">"navigationBarTextStyle"</span><span class="token operator">:</span><span class="token string">"black"</span>
 <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li><p>字段的含义</p>
<p> 1）pages 字段⸺⽤于描述当前⼩程序所有⻚⾯路径，这是为了让微信客⼾端知道当前你的⼩程序⻚⾯定义在哪个⽬录。</p>
</li>
</ol>
<p>​	<code>默认显示此字段中的第一项</code></p>
<p>​	2）window 字段⸺定义⼩程序所有⻚⾯的顶部背景颜⾊，⽂字颜⾊定义等。</p>
<p>​	3）完整的配置信息请参考 app.json配置</p>
<p>​	4) <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html#tabBar">tabBar</a>-底部 <code>tab</code> 栏的表现:<br><img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/tabBar_%E5%BA%95%E9%83%A8tab%E6%A0%8F%E7%9A%84%E8%A1%A8%E7%8E%B0%E7%A4%BA%E4%BE%8B%E5%9B%BE.png" alt="image-20210421102125607"></p>
<p>更多配置详细请看<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html"><code>app配置文档</code></a></p>
</blockquote>
<h3 id="Ⅱ-页面配置page-json"><a href="#Ⅱ-页面配置page-json" class="headerlink" title="Ⅱ-页面配置page.json"></a>Ⅱ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html">页面配置page.json</a></h3><blockquote>
<ol>
<li><p>这⾥的 <code>page.json</code> 其实⽤来表⽰⻚⾯⽬录下的 page.json 这类和⼩程序⻚⾯相关的配置。 开发者可以独⽴定义每个⻚⾯的⼀些属性，如顶部颜⾊、是否允许下拉刷新等等。 ⻚⾯的配置只能设置 app.json 中部分 window 配置项的内容，⻚⾯中配置项会覆盖 app.json 的 window 中相同的配置项。</p>
</li>
<li><p>常用配置属性列举:</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>属性</th>
<th>类型</th>
<th>默认值</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>navigationBarBackgroundColor</td>
<td>HexColor</td>
<td>#000000</td>
<td>导航栏背景颜⾊，如 #000000</td>
</tr>
<tr>
<td>navigationBarTextStyle</td>
<td>String</td>
<td>white</td>
<td>导航栏标题颜⾊，仅⽀持 black &#x2F; white</td>
</tr>
<tr>
<td>navigationBarTitleText</td>
<td>String</td>
<td></td>
<td>导航栏标题⽂字内容</td>
</tr>
<tr>
<td>backgroundColor</td>
<td>HexColor</td>
<td>#ffffff</td>
<td>窗⼝的背景⾊</td>
</tr>
<tr>
<td>backgroundTextStyle</td>
<td>String</td>
<td>dark</td>
<td>下拉<code>loading</code>的样式，仅⽀持 dark &#x2F; light</td>
</tr>
<tr>
<td>enablePullDownRefresh</td>
<td>Boolean</td>
<td>false</td>
<td>是否全局开启下拉刷新。 详⻅ <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#onpulldownrefresh">Page.onPullDownRefresh</a></td>
</tr>
<tr>
<td>onReachBottomDistance</td>
<td>Number</td>
<td>50</td>
<td>⻚⾯上拉触底事件触发时距⻚⾯底部距离，单位为px。 详⻅ <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html#onreachbottom">Page.onReachBottom</a></td>
</tr>
<tr>
<td>disableScroll</td>
<td>Boolean</td>
<td>false</td>
<td>设置为 true 则⻚⾯整体不能上下滚动；只在⻚⾯配置中有效，⽆法在 app.json 中设置该项</td>
</tr>
</tbody></table>
</blockquote>
<h3 id="Ⅲ-sitemap-配置-了解即可"><a href="#Ⅲ-sitemap-配置-了解即可" class="headerlink" title="Ⅲ-sitemap 配置-了解即可"></a>Ⅲ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/sitemap.html">sitemap 配置</a>-了解即可</h3><blockquote>
<p>⼩程序根⽬录下的 <code>sitemap.json</code> ⽂件⽤于配置⼩程序及其⻚⾯是否允许被微信索引。<code>主要服务于搜索</code></p>
</blockquote>
<h2 id="4、小程序框架接口"><a href="#4、小程序框架接口" class="headerlink" title="4、小程序框架接口"></a>4、小程序框架接口</h2><h3 id="Ⅰ-App-Object-object"><a href="#Ⅰ-App-Object-object" class="headerlink" title="Ⅰ-App(Object object)"></a>Ⅰ-App(Object object)</h3><blockquote>
<ol>
<li><p>注册小程序。接受一个 <code>Object</code> 参数，其指定小程序的生命周期回调等。</p>
</li>
<li><p><strong>App() 必须在 <code>app.js</code> 中调用，必须调用且只能调用一次。不然会出现无法预期的后果</strong></p>
</li>
<li><p>相应的app()参数在下方的<code>小程序生命周期中有指出</code></p>
</li>
</ol>
</blockquote>
<h4 id="AppObject-getApp-Object-object"><a href="#AppObject-getApp-Object-object" class="headerlink" title="AppObject getApp(Object object)"></a><strong>AppObject <code>getApp(Object object)</code></strong></h4><blockquote>
<ol>
<li><p>获取到小程序全局唯一的 <code>App</code> 实例。</p>
</li>
<li><p>代码示例</p>
</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token comment" spellcheck="true">// other.js</span>
<span class="token keyword">var</span> appInstance <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>appInstance<span class="token punctuation">.</span>globalData<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// I am global dat</span>
<span class="token comment" spellcheck="true">//或者</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>GbaseUrl<span class="token punctuation">}</span> <span class="token operator">=</span><span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment" spellcheck="true">//GbaseUrl是自己在app.js定义的全局变量</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>Object object</li>
</ol>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">默认值</th>
<th align="left">必填</th>
<th align="left">说明</th>
<th align="left">最低版本</th>
</tr>
</thead>
<tbody><tr>
<td align="left">allowDefault</td>
<td align="left">boolean</td>
<td align="left">false</td>
<td align="left">否</td>
<td align="left">在 <code>App</code> 未定义时返回默认实现。当App被调用时，默认实现中定义的属性会被覆盖合并到App中。一般用于<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/subpackages/independent.html">独立分包</a></td>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.2.4</a></td>
</tr>
</tbody></table>
<ol start="4">
<li>注意</li>
</ol>
<ul>
<li>不要在定义于 <code>App()</code> 内的函数中，或调用 <code>App</code> 前调用 <code>getApp()</code> 。使用 <code>this</code> 就可以拿到 app 实例。</li>
<li>通过 <code>getApp()</code> 获取实例之后，不要私自调用生命周期函数</li>
</ul>
</blockquote>
<hr>
<h1 id="三、小程序的基础知识储备"><a href="#三、小程序的基础知识储备" class="headerlink" title="三、小程序的基础知识储备"></a>三、小程序的基础知识储备</h1><blockquote>
<p>整个小程序学习过程中遇到的 所需基础知识 或 补充知识 将整合至此</p>
<p>相关知识点本人在<code>一二阶段补缺笔记</code>中有记录,在此便只举例大概,不详细记录</p>
</blockquote>
<h2 id="1、Flex-布局"><a href="#1、Flex-布局" class="headerlink" title="1、Flex 布局"></a>1、Flex 布局</h2><h3 id="Ⅰ-基本知识点概念"><a href="#Ⅰ-基本知识点概念" class="headerlink" title="Ⅰ-基本知识点概念"></a>Ⅰ-基本知识点概念</h3><blockquote>
<ol>
<li><p>Flex基本概念</p>
<ol>
<li><p>Flex 是 Flexible Box 的缩写，意为”弹性布局”，用来为盒状模型提供最大的灵活性。 </p>
</li>
<li><p>任何一个容器都可以指定为 Flex 布局。 </p>
</li>
<li><p>display: ‘flex’</p>
</li>
</ol>
</li>
</ol>
<p>​	<img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210421111211248.png" alt="image-20210421111211248"></p>
<p>​	4) 这部分是一阶段基础知识,可看<a target="_blank" rel="noopener" href="http://www.runoob.com/w3cnote/flex-grammar.html">文档</a>学习</p>
<ol start="2">
<li>在小程序中,通常使用<code>&lt;view/&gt;</code>代替<code>&lt;div/&gt;</code>作为容器来做布局–&gt;代码示例在<code>第一章的第三小节第三点</code></li>
</ol>
</blockquote>
<h3 id="Ⅱ-解决flex布局中-space-between方法的排版问题"><a href="#Ⅱ-解决flex布局中-space-between方法的排版问题" class="headerlink" title="Ⅱ-解决flex布局中 space-between方法的排版问题"></a>Ⅱ-解决flex布局中 space-between方法的排版问题</h3><blockquote>
<p>详见下方<code>杂记-初学阶段遇到的问题与解决-问题Ⅷ</code></p>
</blockquote>
<h2 id="2、移动端相关知识点"><a href="#2、移动端相关知识点" class="headerlink" title="2、移动端相关知识点"></a>2、移动端相关知识点</h2><blockquote>
<p>自行补充学习,相关知识点本人在<code>一二阶段补缺笔记</code>中有记录,便不再赘述</p>
</blockquote>
<h3 id="Ⅰ-物理像素"><a href="#Ⅰ-物理像素" class="headerlink" title="Ⅰ-物理像素"></a>Ⅰ-物理像素</h3><blockquote>
<ol>
<li><p>屏幕的分辨率 </p>
</li>
<li><p>设备能控制显示的最小单元，可以把物理像素看成是对应的像素点</p>
</li>
</ol>
</blockquote>
<h3 id="Ⅱ-设备独立像素-、-css-像素"><a href="#Ⅱ-设备独立像素-、-css-像素" class="headerlink" title="Ⅱ-设备独立像素 、 css 像素"></a>Ⅱ-设备独立像素 、 css 像素</h3><blockquote>
<p>设备独立像素(也叫密度无关像素)，可以认为是计算机坐标系统中的一个点，这个点代表一个可以由程序使用并控制的<code>虚拟像素</code>(比如：CSS 像素,只是在 android 机中 CSS 像素就不叫”CSS 像素”了而是叫”设备独立像素”)，然后由相关系统转换为物理像素。 </p>
</blockquote>
<h3 id="Ⅲ-dpr比-、DPI-、PPI"><a href="#Ⅲ-dpr比-、DPI-、PPI" class="headerlink" title="Ⅲ-dpr比 、DPI 、PPI"></a>Ⅲ-dpr比 、DPI 、PPI</h3><blockquote>
<ol>
<li><p>概念</p>
<ol>
<li><p>dpr: 设备像素比，物理像素&#x2F;设备独立像素 &#x3D; dpr， 一般以 Iphon6 的 dpr 为准 dpr &#x3D; 2</p>
</li>
<li><p>PPI: 一英寸显示屏上的像素点个数 </p>
</li>
<li><p>DPI：最早指的是打印机在单位面积上打印的墨点数，墨点越多越清晰</p>
</li>
</ol>
</li>
<li><p>不同机型对比表</p>
</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210508115100483.png" alt="image-20210508115100483"></p>
<ol start="3">
<li>部分机型图示</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210508115306709.png" alt="image-20210508115306709"></p>
</blockquote>
<h2 id="3、移动端适配方案"><a href="#3、移动端适配方案" class="headerlink" title="3、移动端适配方案"></a>3、移动端适配方案</h2><blockquote>
<p>相关知识点本人在<code>一二阶段补缺笔记</code>中有记录,想详细查阅可以去看,这是个<code>面试考点</code></p>
</blockquote>
<h3 id="Ⅰ-viewport-适配"><a href="#Ⅰ-viewport-适配" class="headerlink" title="Ⅰ-viewport 适配"></a>Ⅰ-viewport 适配</h3><blockquote>
<ol>
<li><p>为什么做 <code>viewport</code> 适配 ?</p>
<p>  a) 手机厂商在生产手机的时候大部分手机默认页面宽度为 980px </p>
<p>  b) 手机实际视口宽度都要小于 980px，如: iphone6 为 750px</p>
<p>  c) 开发需求需要将 980 的页面完全显示在手机屏幕上且没有滚动条 </p>
</li>
<li><p>代码实现</p>
</li>
</ol>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>width<span class="token punctuation">=</span>device-width,initial-scale<span class="token punctuation">=</span>1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> 
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅱ-rem-适配"><a href="#Ⅱ-rem-适配" class="headerlink" title="Ⅱ- rem 适配"></a>Ⅱ- rem 适配</h3><blockquote>
<ol>
<li>为什么做 <code>rem</code> 适配?</li>
</ol>
<p>  a) 机型太多,不同的机型屏幕大小不一样 </p>
<p>  b) 需求：一套设计稿的内容在不同的机型上呈现的效果一致,根据屏幕大小不同的变化,页面中的内容也相应变化</p>
<ol start="2">
<li>原生代码实现:</li>
</ol>
<pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">function</span> <span class="token function">remRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
<span class="token keyword">let</span> clientWidth <span class="token operator">=</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientWidth<span class="token punctuation">;</span> 
<span class="token comment" spellcheck="true">// 将屏幕等分 10 份</span>
<span class="token keyword">let</span> rem <span class="token operator">=</span> clientWidth <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> rem <span class="token operator">+</span> <span class="token string">'px'</span><span class="token punctuation">;</span>
document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>style<span class="token punctuation">.</span>fontSize <span class="token operator">=</span> <span class="token string">'12px'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'pageshow'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
<span class="token function">remRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">// 函数防抖</span>
<span class="token keyword">let</span> timeoutId<span class="token punctuation">;</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'resize'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
timeoutId <span class="token operator">&amp;&amp;</span> <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timeoutId<span class="token punctuation">)</span><span class="token punctuation">;</span>
timeoutId <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span><span class="token punctuation">{</span>
<span class="token function">remRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">300</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>第三方库实现</li>
</ol>
<blockquote>
<p>lib-flexible + px2rem-loader</p>
</blockquote>
</blockquote>
<hr>
<h1 id="四、视图层详解"><a href="#四、视图层详解" class="headerlink" title="四、视图层详解"></a>四、视图层详解</h1><blockquote>
<p>框架的视图层由 WXML 与 WXSS 编写，由组件来进行展示。</p>
<p>将逻辑层的数据反映成视图，同时将视图层的事件发送给逻辑层。</p>
<p>WXML(WeiXin Markup language) 用于描述页面的结构。</p>
<p>WXS(WeiXin Script) 是小程序的一套脚本语言，结合 <code>WXML</code>，可以构建出页面的结构。</p>
<p>WXSS(WeiXin Style Sheet) 用于描述页面的样式。</p>
<p>组件(Component)是视图的基本组成单元。</p>
<p>该部分将<code>截取官方文档</code>并加以注解</p>
</blockquote>
<h2 id="1、WXSS样式文件详解"><a href="#1、WXSS样式文件详解" class="headerlink" title="1、WXSS样式文件详解"></a>1、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxss.html">WXSS</a>样式文件详解</h2><blockquote>
<ol>
<li><p>WXSS (WeiXin Style Sheets)是一套样式语言，用于描述 WXML 的组件样式。</p>
</li>
<li><p>WXSS 用来决定 WXML 的组件应该怎么显示。</p>
</li>
</ol>
<p>  为了适应广大的前端开发者，WXSS 具有 CSS 大部分特性。同时为了更适合开发微信小程序，WXSS 对 CSS 进行了扩充以及修改。</p>
<ol start="3">
<li><p>与 CSS 相比，WXSS 扩展的特性有：</p>
<ol>
<li>响应式⻓度单位:即尺寸单位 –&gt;<code>rpx</code></li>
<li>样式导入</li>
</ol>
</li>
<li><p>注意:</p>
</li>
</ol>
<p>  当页面文件在同一级目录下且命名相同(后缀不同),<code>可以互相引用却不用导入</code></p>
</blockquote>
<h3 id="Ⅰ-尺寸单位"><a href="#Ⅰ-尺寸单位" class="headerlink" title="Ⅰ-尺寸单位"></a>Ⅰ-尺寸单位</h3><blockquote>
<ol>
<li><code>rpx（responsive pixel）</code>: 可以根据屏幕宽度进行自适应。规定屏幕宽为750rpx。如在 <code>iPhone6</code> 上，屏幕宽度为375px，共有750个物理像素，则750rpx &#x3D; 375px &#x3D; 750物理像素，1rpx &#x3D; 0.5px &#x3D; 1物理像素。</li>
</ol>
<table>
<thead>
<tr>
<th align="left">设备</th>
<th align="left">rpx换算px (屏幕宽度&#x2F;750)</th>
<th align="left">px换算rpx (750&#x2F;屏幕宽度)</th>
</tr>
</thead>
<tbody><tr>
<td align="left">iPhone5</td>
<td align="left">1rpx &#x3D; 0.42px</td>
<td align="left">1px &#x3D; 2.34rpx</td>
</tr>
<tr>
<td align="left">iPhone6</td>
<td align="left">1rpx &#x3D; 0.5px</td>
<td align="left">1px &#x3D; 2rpx</td>
</tr>
<tr>
<td align="left">iPhone6 Plus</td>
<td align="left">1rpx &#x3D; 0.552px</td>
<td align="left">1px &#x3D; 1.81rpx</td>
</tr>
</tbody></table>
<ol start="2">
<li><p>建议与注意点:</p>
<ol>
<li>开发微信小程序时<code>推荐设计师可以用iPhone6作为视觉稿的标准</code>–&gt;即只有在<code>iPhone6</code>标准中才可以<code>一比二换算</code>,更方便</li>
<li>在较小的屏幕上不可避免的会有一些毛刺，请在开发时尽量避免这种情况</li>
</ol>
</li>
</ol>
</blockquote>
<h3 id="Ⅱ-样式导⼊"><a href="#Ⅱ-样式导⼊" class="headerlink" title="Ⅱ-样式导⼊"></a>Ⅱ-样式导⼊</h3><blockquote>
<ol>
<li>使用<code>@import</code>语句可以导入外联样式表,也可以和less中的导⼊混⽤，<code>@import</code>后跟需要导入的外联样式表的<code>相对路径</code>(只⽀持相对路径)，用<code>;</code>表示语句结束。</li>
</ol>
<pre class="line-numbers language-css"><code class="language-css"><span class="token comment" spellcheck="true">/** common.wxss **/</span>
<span class="token selector"><span class="token class">.small-p</span> </span><span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span><span class="token number">5</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">/** app.wxss **/</span>
<span class="token atrule"><span class="token rule">@import</span> <span class="token string">"common.wxss"</span><span class="token punctuation">;</span></span>
<span class="token selector"><span class="token class">.middle-p</span> </span><span class="token punctuation">{</span>
  <span class="token property">padding</span><span class="token punctuation">:</span><span class="token number">15</span>px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅲ-内联样式"><a href="#Ⅲ-内联样式" class="headerlink" title="Ⅲ-内联样式"></a>Ⅲ-内联样式</h3><blockquote>
<p>框架组件上支持使用 style、class 属性来控制组件的样式。</p>
<ol>
<li><code>style</code>：静态的样式统一写到 class 中。style 接收动态的样式，在运行时会进行解析，请尽量避免将静态的样式写进 style 中，以免影响渲染速度</li>
</ol>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token style-attr language-css"><span class="token attr-name"> <span class="token attr-name">style</span></span><span class="token punctuation">="</span><span class="token attr-value"><span class="token selector">color:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>color<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span></span><span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="2">
<li><code>class</code>：用于指定样式规则，其属性值是样式规则中类选择器名(样式类名)的集合，样式类名不需要带上<code>.</code>，样式类名之间用空格分隔</li>
</ol>
<pre class="line-numbers language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>normal_view<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</blockquote>
<h2 id="2、WXML语法详解"><a href="#2、WXML语法详解" class="headerlink" title="2、WXML语法详解"></a>2、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/">WXML</a>语法详解</h2><blockquote>
<p>WXML（WeiXin Markup Language）是框架设计的⼀套标签语⾔，结合<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/">基础组件</a>、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html">事件系统</a>，可以构建出⻚⾯的结构。</p>
<p>该部分将<code>截取官方文档</code>加以自己见解说明,同学们也可以直接去看文档</p>
</blockquote>
<h3 id="Ⅰ-数据绑定与写法规则"><a href="#Ⅰ-数据绑定与写法规则" class="headerlink" title="Ⅰ-数据绑定与写法规则"></a>Ⅰ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/wxml/data.html#%E5%86%85%E5%AE%B9">数据绑定与写法规则</a></h3><blockquote>
<ol>
<li><p>WXML 中的动态数据均来自对应 Page 的 data。</p>
</li>
<li><p>Mustache 语法{{}}视作运算标记,里面的内容表示表达式</p>
</li>
</ol>
</blockquote>
<h4 id="1-单向简单数据绑定"><a href="#1-单向简单数据绑定" class="headerlink" title="1) 单向简单数据绑定"></a>1) 单向简单数据绑定</h4><blockquote>
<ol>
<li><p>此处是单向绑定(数据驱动视图),双向绑定出现的场景如(input等)将在下方<code>四-3、双向绑定</code>处记录</p>
</li>
<li><p><code>简单绑定</code>:数据绑定使用 Mustache 语法（双大括号）将变量包起来，可以作用于：</p>
</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token comment" spellcheck="true">//pages.wxml</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><span class="token punctuation">{</span> message <span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">// pages.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    message<span class="token punctuation">:</span> <span class="token string">'Hello MINA!'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>绑定<code>boolean</code>类型(需要在双引号之内)</li>
</ol>
<p>  <code>true</code>：boolean 类型的 true，代表真值。<code>false</code>： boolean 类型的 false，代表假值。</p>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>checkbox</span> <span class="token attr-name">checked</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{false}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>checkbox</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>  <em><strong>特别注意：不要直接写 <code>checked=&quot;false&quot;</code>，其计算结果是一个字符串，转成 boolean 类型后代表真值</strong></em></p>
</blockquote>
<h4 id="2-运算"><a href="#2-运算" class="headerlink" title="2) 运算"></a>2) 运算</h4><blockquote>
<p>可以在 <code>{{}}</code> 内进行简单的运算，支持的有如下几种方式：</p>
<ol>
<li>三元运算</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">hidden</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{flag</span> <span class="token attr-name">?</span> <span class="token attr-name">true</span> <span class="token attr-name">:</span> <span class="token attr-name">false}}"</span><span class="token punctuation">></span></span> Hidden <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="2">
<li>算数运算</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><span class="token punctuation">{</span>a <span class="token operator">+</span> b<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">+</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>c<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">+</span> d <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">//view中的内容为 `3 + 3 + d`。</span>
<span class="token comment" spellcheck="true">//pages.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span> a<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> b<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span> c<span class="token punctuation">:</span> <span class="token number">3</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>逻辑判断</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{length</span> <span class="token punctuation">></span> <span class="token attr-name">5}}"</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="4">
<li>字符串运算</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token string">"hello"</span> <span class="token operator">+</span> name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span> 'MINA<span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="5">
<li>数据路径运算</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token punctuation">{</span>object<span class="token punctuation">.</span>key<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">//view中的内容为 hello  MINA</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    object<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      key<span class="token punctuation">:</span> <span class="token string">'Hello '</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    array<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'MINA'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h4 id="3-组合"><a href="#3-组合" class="headerlink" title="3) 组合"></a>3) 组合</h4><blockquote>
<p>也可以在 Mustache 内直接进行组合，构成新的对象或者数组。</p>
<ol>
<li>数组 –&gt; 最终组合成数组<code>[0, 1, 2, 3, 4]</code>。</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{[zero,</span> <span class="token attr-name">1,</span> <span class="token attr-name">2,</span> <span class="token attr-name">3,</span> <span class="token attr-name">4]}}"</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span> zero<span class="token punctuation">:</span> <span class="token number">0</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li><p>对象   –&gt;</p>
<ol>
<li><p>最终组合成的对象是 <code>&#123;for: 1, bar: 2&#125;</code> </p>
<pre class="line-numbers language-JSx"><code class="language-JSx"><template is="objectCombine" data="{{for: a, bar: b}}"></template>
Page({
  data: {a: 1, b: 2}
})
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>也可以用扩展运算符 <code>...</code> 来将一个对象展开–&gt;最终组合成的对象是 <code>&#123;a: 1, b: 2, c: 3, d: 4, e: 5&#125;</code>。</p>
<pre class="line-numbers language-JSx"><code class="language-JSx"><template is="objectCombine" data="{{...obj1, ...obj2, e: 5}}"></template>
Page({
  data: {
    obj1: { a: 1, b: 2 },
    obj2: { c: 3, d: 4}
  }
})
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>如果对象的 key 和 value 相同，也可以间接地表达。–&gt;最终组合成的对象是 <code>&#123;foo: &#39;my-foo&#39;, bar:&#39;my-bar&#39;&#125;</code></p>
<pre class="line-numbers language-JSx"><code class="language-JSx"><template is="objectCombine" data="{{foo, bar}}"></template>
Page({
  data: {
    foo: 'my-foo',
    bar: 'my-bar'
  }
})
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><code>注意</code>：上述方式可以随意组合，但是如有存在变量名相同的情况，后边的会覆盖前面 –&gt; 最终组合成的对象是 <code>&#123;a: 5, b: 3, c: 6&#125;</code>。</p>
<pre class="line-numbers language-JSx"><code class="language-JSx"><template is="objectCombine" data="{{...obj1, ...obj2, a, c: 6}}"></template>
Page({
  data: {
    obj1: { a: 1,  b: 2},
    obj2: { b: 3, c: 4},
    a: 5
  }
})
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p><code>注意</code>： 花括号和引号之间如果有空格，将最终被解析成为字符串</p>
<pre class="line-numbers language-JSx"><code class="language-JSx">  <view wx:for="{{[1,2,3]}} ">
    {{item}}
  </view>
  等同于
                        
  <view wx:for="{{[1,2,3] + ' '}}">
    {{item}}
  </view>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ol>
</li>
</ol>
</blockquote>
<h4 id="4-自定义属性data-的命名与使用"><a href="#4-自定义属性data-的命名与使用" class="headerlink" title="4) 自定义属性data-*的命名与使用"></a>4) 自定义属性<code>data-*</code>的命名与使用</h4><blockquote>
<ol>
<li>同一容器中可以存在多个<code>data-*</code></li>
<li>凡是以<code>data-</code>开头的数据,都会在<code>event的currentTarget</code>中体现,且回缺省<code>data-</code>(data-id  –&gt;  id)</li>
<li><code>data-*</code>后面接的单词将自动转换 第一个单词首字母小写,第二个及之后的单词首字母大写 (data-post-my-id –&gt; postMyId)</li>
</ol>
</blockquote>
<h3 id="Ⅱ-列表渲染"><a href="#Ⅱ-列表渲染" class="headerlink" title="Ⅱ-列表渲染"></a>Ⅱ-列表渲染</h3><h4 id="1-wx-for"><a href="#1-wx-for" class="headerlink" title="1) wx:for"></a>1) wx:for</h4><blockquote>
<ol>
<li><p>在组件上使用 <code>wx:for</code> 控制属性绑定一个数组，即可使用数组中各项的数据重复渲染该组件。</p>
</li>
<li><p>默认数组的当前项的下标变量名默认为 <code>index</code>，数组当前项的变量名默认为 <code>item</code></p>
</li>
<li><p>使用 <code>wx:for-item</code> 可以指定数组当前元素的变量名，使用 <code>wx:for-index</code> 可以指定数组当前下标的变量名：</p>
</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{array}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>idx<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>itemName<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token punctuation">{</span><span class="token punctuation">{</span>idx<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>itemName<span class="token punctuation">.</span>message<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="4">
<li><code>wx:for</code> 也可以嵌套，下边是一个九九乘法表</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{[1,</span> <span class="token attr-name">2,</span> <span class="token attr-name">3,</span> <span class="token attr-name">4,</span> <span class="token attr-name">5,</span> <span class="token attr-name">6,</span> <span class="token attr-name">7,</span> <span class="token attr-name">8,</span> <span class="token attr-name">9]}}"</span> <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>i<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{[1,</span> <span class="token attr-name">2,</span> <span class="token attr-name">3,</span> <span class="token attr-name">4,</span> <span class="token attr-name">5,</span> <span class="token attr-name">6,</span> <span class="token attr-name">7,</span> <span class="token attr-name">8,</span> <span class="token attr-name">9]}}"</span> <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>j<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{i</span> <span class="token attr-name">&lt;</span><span class="token attr-value"><span class="token punctuation">=</span> j}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">*</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>j<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">=</span><span class="token string">"{{i"</span> j<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">&lt;</span> view<span class="token operator">></span> <span class="token operator">&lt;</span> code<span class="token operator">></span><span class="token operator">&lt;</span><span class="token operator">/</span><span class="token operator">=</span><span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h4 id="2-block-wx-for"><a href="#2-block-wx-for" class="headerlink" title="2) block wx:for"></a>2) block wx:for</h4><blockquote>
<p>类似 <code>block wx:if</code>，也可以将 <code>wx:for</code> 用在<code>&lt;block/&gt;</code>标签上，以渲染一个包含多节点的结构块。例如：</p>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{[1,</span> <span class="token attr-name">2,</span> <span class="token attr-name">3]}}"</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>注意：</strong> <code>&lt;block/&gt;</code> 并不是一个组件，它仅仅是一个包装元素，不会在页面中做任何渲染，只接受控制属性</p>
</blockquote>
<h4 id="3-wx-key"><a href="#3-wx-key" class="headerlink" title="3) wx:key"></a>3) wx:key</h4><blockquote>
<p>如果列表中项目的位置会动态改变或者有新的项目添加到列表中，并且希望列表中的项目保持自己的特征和状态（如 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/input.html">input</a> 中的输入内容，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/switch.html">switch</a> 的选中状态），需要使用 <code>wx:key</code> 来指定列表中项目的唯一的标识符。</p>
</blockquote>
<h5 id="①-wx-key-的值以两种形式提供"><a href="#①-wx-key-的值以两种形式提供" class="headerlink" title="① wx:key 的值以两种形式提供"></a>① <code>wx:key</code> 的值以两种形式提供</h5><blockquote>
<ol>
<li><p>字符串，代表在for循环的array中<code>item的某个property</code>，该property的值需要是列表中唯一的字符串或数字，且不能动态改变。</p>
</li>
<li><p>保留关键字 <code>*this</code> 代表在 for 循环中的 item 本身，这种表示需要 item 本身是一个<code>唯一的字符串或者数字</code>。</p>
</li>
</ol>
<pre class="line-numbers language-JSX"><code class="language-JSX"><block wx:for="{{posts}}"   wx:key="id"></blocK>
//id是posts数组中的对象里的一个属性
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</blockquote>
<h5 id="②使用-wx-key-的意义"><a href="#②使用-wx-key-的意义" class="headerlink" title="②使用 wx:key 的意义"></a>②使用 <code>wx:key</code> 的意义</h5><blockquote>
<p>当数据改变触发渲染层重新渲染的时候，会校正带有 key 的组件<code>，框架会确保他们被重新排序，而不是重新创建</code>，以确保使组件保持自身的状态，并且提高列表渲染时的效率。</p>
<p>如不提供 <code>wx:key</code>，会报一个 <code>warning</code>， 如果明确知道该列表是静态，或者不必关注其顺序，可以选择忽略。</p>
</blockquote>
<h4 id="4-列表渲染注意点"><a href="#4-列表渲染注意点" class="headerlink" title="4) 列表渲染注意点"></a>4) 列表渲染注意点</h4><h5 id="①-当-wx-for-的值为字符串时，会将字符串解析成字符串数组"><a href="#①-当-wx-for-的值为字符串时，会将字符串解析成字符串数组" class="headerlink" title="① 当 wx:for 的值为字符串时，会将字符串解析成字符串数组"></a>① 当 <code>wx:for</code> 的值为字符串时，会将字符串解析成字符串数组</h5><blockquote>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>array<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
等同于

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{[<span class="token punctuation">'</span>a<span class="token punctuation">'</span>,<span class="token punctuation">'</span>r<span class="token punctuation">'</span>,<span class="token punctuation">'</span>r<span class="token punctuation">'</span>,<span class="token punctuation">'</span>a<span class="token punctuation">'</span>,<span class="token punctuation">'</span>y<span class="token punctuation">'</span>]}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h5 id="②-花括号和引号之间如果有空格，将最终被解析成为字符串"><a href="#②-花括号和引号之间如果有空格，将最终被解析成为字符串" class="headerlink" title="② 花括号和引号之间如果有空格，将最终被解析成为字符串"></a>② 花括号和引号之间如果有空格，将最终被解析成为字符串</h5><blockquote>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{[1,2,3]}}</span> <span class="token attr-name">"</span><span class="token punctuation">></span></span>
 <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
等同于

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{[1,2,3]</span> <span class="token attr-name">+</span> <span class="token attr-name">'</span> <span class="token attr-name">'}}"</span> <span class="token punctuation">></span></span>
 <span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅲ-条件渲染"><a href="#Ⅲ-条件渲染" class="headerlink" title="Ⅲ-条件渲染"></a>Ⅲ-条件渲染</h3><h4 id="1-wx-if"><a href="#1-wx-if" class="headerlink" title="1) wx:if"></a>1) wx:if</h4><blockquote>
<ol>
<li>在框架中，使用 <code>wx:if=&quot;&quot;</code> 来判断是否需要渲染该代码块：</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{condition}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span> True <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="2">
<li>也可以用 <code>wx:elif</code> 和 <code>wx:else</code> 来添加一个 else 块:</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{length</span> <span class="token punctuation">></span> <span class="token attr-name">5}}"</span><span class="token punctuation">></span></span> <span class="token number">1</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>elif</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{length</span> <span class="token punctuation">></span> <span class="token attr-name">2}}"</span><span class="token punctuation">></span></span> <span class="token number">2</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span><span class="token punctuation">></span></span> <span class="token number">3</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h4 id="2-block-wx-if"><a href="#2-block-wx-if" class="headerlink" title="2) block wx:if"></a>2) block wx:if</h4><blockquote>
<p>因为 <code>wx:if</code> 是一个控制属性，需要将它添加到一个标签上。如果要一次性判断多个组件标签，可以使用一个 <code>&lt;block/&gt;</code> 标签将多个组件包装起来，并在上边使用 <code>wx:if</code> 控制属性</p>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{true}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> view1 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> view2 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p><strong>注意：</strong> <code>&lt;block/&gt;</code> 并不是一个组件，它仅仅是一个包装元素，不会在页面中做任何渲染，只接受控制属性</p>
</blockquote>
<h4 id="3-wx-if-vs-hidden"><a href="#3-wx-if-vs-hidden" class="headerlink" title="3) wx:if vs hidden"></a>3) <code>wx:if</code> vs <code>hidden</code></h4><blockquote>
<ol>
<li><p>因为 <code>wx:if</code> 之中的模板也可能包含数据绑定，所以当 <code>wx:if</code> 的条件值切换时，框架有一个局部渲染的过程，因为它会确保条件块在切换时销毁或重新渲染。</p>
</li>
<li><p>同时 <code>wx:if</code> 也是<strong>惰性的</strong>，如果在初始渲染条件为 <code>false</code>，框架什么也不做，在条件第一次变成真的时候才开始局部渲染。</p>
</li>
</ol>
<p>  相比之下，<code>hidden</code> 就简单的多，组件始终会被渲染，只是简单的控制显示与隐藏。</p>
<ol start="3">
<li>一般来说，<code>wx:if</code> 有更高的切换消耗而 <code>hidden</code> 有更高的初始渲染消耗。因此，如果需要频繁切换的情景下，用 <code>hidden</code> 更好，如果在运行时条件不大可能改变则 <code>wx:if</code> 较好。</li>
</ol>
</blockquote>
<h3 id="Ⅳ-模板"><a href="#Ⅳ-模板" class="headerlink" title="Ⅳ-模板"></a>Ⅳ-模板</h3><blockquote>
<ol>
<li><p>WXML提供模板（template），可以在模板中定义代码片段，然后在不同的地方调用</p>
</li>
<li><p>模板拥有自己的<code>作用域</code>，只能使用 <code>data</code> 传入的数据以及模板定义文件中定义的 <code>&lt;wxs /&gt;</code> 模块。</p>
</li>
</ol>
</blockquote>
<h4 id="1-定义模板"><a href="#1-定义模板" class="headerlink" title="1) 定义模板"></a>1) 定义模板</h4><blockquote>
<p>使用 name 属性，作为模板的名字。然后在<code>&lt;template/&gt;</code>内定义代码片段，如</p>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>
 index<span class="token punctuation">:</span> int
 msg<span class="token punctuation">:</span> string
 time<span class="token punctuation">:</span> string
<span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msgItem<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">></span></span> <span class="token punctuation">{</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>msg<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">></span></span> Time<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>time<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h4 id="2-使用模板"><a href="#2-使用模板" class="headerlink" title="2) 使用模板"></a>2) 使用模板</h4><blockquote>
<ol>
<li>使用 is 属性，声明需要的使用的模板，然后将模板所需要的 data 传入，如：</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>msgItem<span class="token punctuation">"</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{...item}}<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    item<span class="token punctuation">:</span> <span class="token punctuation">{</span> index<span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">,</span> msg<span class="token punctuation">:</span> <span class="token string">'this is a template'</span><span class="token punctuation">,</span> time<span class="token punctuation">:</span> <span class="token string">'2016-09-15'</span><span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>is 属性可以使用 Mustache 语法，来动态决定具体需要渲染哪个模板：</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>odd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> odd <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>even<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> even <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{[1,</span> <span class="token attr-name">2,</span> <span class="token attr-name">3,</span> <span class="token attr-name">4,</span> <span class="token attr-name">5]}}"</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{item</span> <span class="token attr-name">%</span> <span class="token attr-name">2</span> <span class="token attr-name">=</span><span class="token attr-value"><span class="token punctuation">=</span> 0</span> <span class="token attr-name">?</span> <span class="token attr-name">'even'</span> <span class="token attr-name">:</span> <span class="token attr-name">'odd'}}"</span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅴ-引用"><a href="#Ⅴ-引用" class="headerlink" title="Ⅴ-引用"></a>Ⅴ-引用</h3><blockquote>
<p>WXML 提供两种文件引用方式<code>import</code>和<code>include</code></p>
</blockquote>
<h4 id="1-import"><a href="#1-import" class="headerlink" title="1) import"></a>1) import</h4><h5 id="①-使用示例"><a href="#①-使用示例" class="headerlink" title="① 使用示例"></a>① 使用示例</h5><blockquote>
<ol>
<li>在 item.wxml 中定义了一个叫<code>item</code>的<code>template</code>：</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> item<span class="token punctuation">.</span>wxml <span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token punctuation">{</span>text<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>在 index.wxml 中引用了 item.wxml，就可以使用<code>item</code>模板：</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item.wxml<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{text:</span> <span class="token attr-name">'forbar'}}"</span><span class="token punctuation">/></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</blockquote>
<h5 id="②-import-的作用域"><a href="#②-import-的作用域" class="headerlink" title="② import 的作用域"></a>② import 的作用域</h5><blockquote>
<p>import有作用域的概念，即只会 import 目标文件中定义的 template，而不会import目标文件import的template。</p>
<p>**如：C import B，B import A，在C中可以使用B定义的<code>template</code>，在B中可以使用A定义的<code>template</code>，但是C不能使用A定义的<code>template</code>**。</p>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> A<span class="token punctuation">.</span>wxml <span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>A<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">></span></span> A template <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> B<span class="token punctuation">.</span>wxml <span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>a.wxml<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>B<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">></span></span> B template <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">></span></span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> C<span class="token punctuation">.</span>wxml <span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>b.wxml<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>A<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span>  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> Error<span class="token operator">!</span> Can not use tempalte when not <span class="token keyword">import</span> A<span class="token punctuation">.</span> <span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>B<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h4 id="2-include"><a href="#2-include" class="headerlink" title="2) include"></a>2) include</h4><blockquote>
<p><code>include</code> 可以将目标文件<strong>除了</strong> <code>&lt;template/&gt;</code> <code>&lt;wxs/&gt;</code> 外的整个代码引入，相当于是拷贝到 <code>include</code> 位置，如：</p>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> index<span class="token punctuation">.</span>wxml <span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>header.wxml<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> body <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>footer.wxml<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> header<span class="token punctuation">.</span>wxml <span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> header <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> footer<span class="token punctuation">.</span>wxml <span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span> footer <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h2 id="3、双向绑定"><a href="#3、双向绑定" class="headerlink" title="3、双向绑定"></a>3、双向绑定</h2><h3 id="Ⅰ-双向绑定语法"><a href="#Ⅰ-双向绑定语法" class="headerlink" title="Ⅰ-双向绑定语法"></a>Ⅰ-双向绑定语法</h3><blockquote>
</blockquote>
<h3 id="Ⅱ-setData–-gt-数据更新"><a href="#Ⅱ-setData–-gt-数据更新" class="headerlink" title="Ⅱ- setData–&gt;数据更新"></a>Ⅱ- <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/performance/tips.html"><code>setData</code></a>–&gt;数据更新</h3><blockquote>
<ol>
<li><p><code>setData</code> 是小程序开发中使用最频繁的接口，也是最容易引发性能问题的接口。</p>
</li>
<li><p>小程序的视图层目前使用 WebView 作为渲染载体，而逻辑层是由独立的 JavascriptCore 作为运行环境。在架构上，WebView 和 JavascriptCore 都是独立的模块，并不具备数据直接共享的通道。当前，视图层和逻辑层的数据传输，实际上通过两边提供的 <code>evaluateJavascript</code> 所实现。即用户传输的数据，①<code>需要将其转换为字符串形式传递</code>，② <code>同时把转换后的数据内容拼接成一份 JS 脚本</code>，③<code>再通过执行 JS 脚本的形式传递到两边独立环境</code>。</p>
</li>
<li><p>而 <code>evaluateJavascript</code> 的执行会受很多方面的影响，数据到达视图层并不是实时的</p>
</li>
</ol>
</blockquote>
<h4 id="1-简单使用"><a href="#1-简单使用" class="headerlink" title="1) 简单使用"></a>1) 简单使用</h4><blockquote>
<p><code>setData</code>可以直接将数据加入data中;如果在data中已经有该值,则修改它有着创建+更新功能  但正常是用来更新</p>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   data<span class="token punctuation">:</span> <span class="token punctuation">{</span>posts<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>test<span class="token punctuation">:</span> <span class="token string">"测试数据"</span><span class="token punctuation">,</span>flag<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
   <span class="token comment" spellcheck="true">//更新</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>posts<span class="token punctuation">:</span> content<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h4 id="2-常见的-setData-操作错误"><a href="#2-常见的-setData-操作错误" class="headerlink" title="2) 常见的 setData 操作错误"></a>2) 常见的 setData 操作错误</h4><h5 id="①-频繁的去-setData"><a href="#①-频繁的去-setData" class="headerlink" title="① 频繁的去 setData"></a>① <strong>频繁的去 setData</strong></h5><blockquote>
<p>在我们分析过的一些案例里，部分小程序会非常频繁（毫秒级）的去<code>setData</code>，其导致了两个后果：</p>
<ul>
<li>Android 下用户在滑动时会感觉到卡顿，操作反馈延迟严重，因为 JS 线程一直在编译执行渲染，未能及时将用户操作事件传递到逻辑层，逻辑层亦无法及时将操作处理结果及时传递到视图层；</li>
<li>渲染有出现延时，由于 WebView 的 JS 线程一直处于忙碌状态，逻辑层到页面层的通信耗时上升，视图层收到的数据消息时距离发出时间已经过去了几百毫秒，渲染的结果并不实时；</li>
</ul>
</blockquote>
<h5 id="②-每次-setData-都传递大量新数据"><a href="#②-每次-setData-都传递大量新数据" class="headerlink" title="② 每次 setData 都传递大量新数据"></a>② <strong>每次 setData 都传递大量新数据</strong></h5><blockquote>
<p>由<code>setData</code>的底层实现可知，我们的数据传输实际是一次 <code>evaluateJavascript</code> 脚本过程，当数据量过大时会增加脚本的编译执行时间，占用 WebView JS 线程，</p>
</blockquote>
<h5 id="③-后台态页面进行-setData"><a href="#③-后台态页面进行-setData" class="headerlink" title="③ 后台态页面进行 setData"></a>③ <strong>后台态页面进行 setData</strong></h5><blockquote>
<p>当页面进入后台态（用户不可见），不应该继续去进行<code>setData</code>，后台态页面的渲染用户是无法感受的，另外后台态页面去<code>setData</code>也会抢占前台页面的执行</p>
</blockquote>
<h2 id="4、事件系统"><a href="#4、事件系统" class="headerlink" title="4、事件系统"></a>4、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html">事件系统</a></h2><h3 id="Ⅰ-什么是事件"><a href="#Ⅰ-什么是事件" class="headerlink" title="Ⅰ-什么是事件?"></a>Ⅰ-什么是事件?</h3><blockquote>
<ul>
<li><code>事件是视图层到逻辑层的通讯方式</code>。</li>
<li>事件可以将用户的行为反馈到逻辑层进行处理。</li>
<li>事件可以绑定在组件上，当达到触发事件，就会执行逻辑层中对应的事件处理函数。</li>
<li>事件对象可以携带额外信息，如 id, dataset, touches。</li>
</ul>
</blockquote>
<h3 id="Ⅱ-事件分类"><a href="#Ⅱ-事件分类" class="headerlink" title="Ⅱ-事件分类"></a>Ⅱ-事件分类</h3><blockquote>
<p>事件分为冒泡事件和非冒泡事件：</p>
<ol>
<li><p><code>冒泡事件</code>：当一个组件上的事件被触发后，该事件会向父节点传递。</p>
</li>
<li><p><code>非冒泡事件</code>：当一个组件上的事件被触发后，该事件不会向父节点传递。</p>
</li>
<li><p>WXML的冒泡事件列表：</p>
</li>
</ol>
<table>
<thead>
<tr>
<th align="left">类型</th>
<th align="left">触发条件</th>
<th align="left">最低版本</th>
</tr>
</thead>
<tbody><tr>
<td align="left">touchstart</td>
<td align="left">手指触摸动作开始</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">touchmove</td>
<td align="left">手指触摸后移动</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">touchcancel</td>
<td align="left">手指触摸动作被打断，如来电提醒，弹窗</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">touchend</td>
<td align="left">手指触摸动作结束</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">tap</td>
<td align="left">手指触摸后马上离开</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">longpress</td>
<td align="left">手指触摸后，超过350ms再离开，如果指定了事件回调函数并触发了这个事件，tap事件将不被触发</td>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.5.0</a></td>
</tr>
<tr>
<td align="left">longtap</td>
<td align="left">手指触摸后，超过350ms再离开（推荐使用longpress事件代替）</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">transitionend</td>
<td align="left">会在 WXSS transition 或 wx.createAnimation 动画结束后触发</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">animationstart</td>
<td align="left">会在一个 WXSS animation 动画开始时触发</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">animationiteration</td>
<td align="left">会在一个 WXSS animation 一次迭代结束时触发</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">animationend</td>
<td align="left">会在一个 WXSS animation 动画完成时触发</td>
<td align="left"></td>
</tr>
<tr>
<td align="left">touchforcechange</td>
<td align="left">在支持 3D Touch 的 iPhone 设备，重按时会触发</td>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.9.90</a></td>
</tr>
</tbody></table>
<ol start="4">
<li><code>注</code>：除上表之外的其他组件自定义事件如无特殊声明<code>都是非冒泡事件</code>，如 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/form.html">form</a> 的<code>submit</code>事件，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/input.html">input</a> 的<code>input</code>事件，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/scroll-view.html">scroll-view</a> 的<code>scroll</code>事件，(详见各个<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/">组件</a>)</li>
</ol>
</blockquote>
<h3 id="Ⅲ-事件的绑定方式"><a href="#Ⅲ-事件的绑定方式" class="headerlink" title="Ⅲ-事件的绑定方式"></a>Ⅲ-事件的绑定方式</h3><h4 id="1-普通事件绑定-bind-绑定"><a href="#1-普通事件绑定-bind-绑定" class="headerlink" title="1) 普通事件绑定-bind 绑定"></a>1) 普通事件绑定-<code>bind</code> 绑定</h4><blockquote>
<ol>
<li>代码示例</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>tapName<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>start_container<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">//也可以加冒号分隔</span>
    <span class="token comment" spellcheck="true">//&lt;view bind:tap="tapName" class='start_container'></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">'</span>start<span class="token punctuation">'</span></span><span class="token punctuation">></span></span>开启小程序之旅<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  tapName<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li><p>如果用户点击这个 view ，则页面的 <code>tapName</code> 会被调用。</p>
</li>
<li><p>此时，页面的 <code>this.data.tapName</code> 必须是一个字符串，指定事件处理函数名；如果它是个空字符串，则这个绑定会失效（可以利用这个特性来暂时禁用一些事件）</p>
</li>
<li><p>自基础库版本 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.5.0</a> 起，在大多数组件和自定义组件中， <code>bind</code> 后可以紧跟一个冒号，其含义不变，如 <code>bind:tap</code> 。基础库版本 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.8.1</a> 起，在所有组件中开始提供这个支持。</p>
</li>
</ol>
</blockquote>
<h4 id="2-绑定并阻止事件冒泡-catch-绑定"><a href="#2-绑定并阻止事件冒泡-catch-绑定" class="headerlink" title="2) 绑定并阻止事件冒泡-catch 绑定:"></a>2) 绑定并阻止事件冒泡-<code>catch</code> 绑定:</h4><blockquote>
<ol>
<li><p>除 <code>bind</code> 外，也可以用 <code>catch</code> 来绑定事件。与 <code>bind</code> 不同， <code>catch</code> 会阻止事件向上冒泡。</p>
</li>
<li><p>代码示例:</p>
</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  outer view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span> <span class="token attr-name">catchtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    middle view
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      inner view
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>例如在上边这个例子中，点击 inner view 会先后调用<code>handleTap3</code>和<code>handleTap2</code>(因为tap事件会冒泡到 middle view，而 middle view 阻止了 tap 事件冒泡，不再向父节点传递)，点击 middle view 会触发<code>handleTap2</code>，点击 outer view 会触发<code>handleTap1</code>。</li>
</ol>
</blockquote>
<h4 id="3-互斥事件绑定"><a href="#3-互斥事件绑定" class="headerlink" title="3) 互斥事件绑定"></a>3) 互斥事件绑定</h4><blockquote>
<ol>
<li><p>自基础库版本 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.8.2</a> 起，除 <code>bind</code> 和 <code>catch</code> 外，还可以使用 <code>mut-bind</code> 来绑定事件。一个 <code>mut-bind</code> 触发后，如果事件冒泡到其他节点上，其他节点上的 <code>mut-bind</code> 绑定函数不会被触发，但 <code>bind</code> 绑定函数和 <code>catch</code> 绑定函数依旧会被触发。</p>
</li>
<li><p>换而言之，所有 <code>mut-bind</code> 是“互斥”的，只会有其中一个绑定函数被触发。同时，它完全不影响 <code>bind</code> 和 <code>catch</code> 的绑定效果</p>
</li>
<li><p>例如在下边这个例子中，点击 inner view 会先后调用 <code>handleTap3</code> 和 <code>handleTap2</code> ，点击 middle view 会调用 <code>handleTap2</code> 和 <code>handleTap1</code></p>
</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">mut-bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap1<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  outer view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>middle<span class="token punctuation">"</span></span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    middle view
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">mut-bind:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap3<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
      inner view
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅳ-事件的捕获阶段"><a href="#Ⅳ-事件的捕获阶段" class="headerlink" title="Ⅳ-事件的捕获阶段"></a>Ⅳ-事件的捕获阶段</h3><blockquote>
<ol>
<li><p>自基础库版本 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.5.0</a> 起，触摸类事件支持捕获阶段。捕获阶段位于冒泡阶段之前，且在捕获阶段中，事件到达节点的顺序与冒泡阶段<code>恰好相反</code>。需要在捕获阶段监听事件时，可以采用<code>capture-bind</code>、<code>capture-catch</code>关键字，后者将中断捕获阶段和取消冒泡阶段。</p>
</li>
<li><p>在下面的代码中，点击 inner view 会先后调用<code>handleTap2</code>、<code>handleTap4</code>、<code>handleTap3</code>、<code>handleTap1</code></p>
</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  outer view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap3<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    inner view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>  如果将上面代码中的第一个capture-bind改为capture-catch，将<code>只触发handleTap2</code>。</p>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>outer<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap1<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-catch:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  outer view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>inner<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap3<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">capture-bind:</span>touchstart</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>handleTap4<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    inner view
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅴ-事件对象"><a href="#Ⅴ-事件对象" class="headerlink" title="Ⅴ-事件对象"></a>Ⅴ-事件对象</h3><blockquote>
<p>如无特殊说明，当组件触发事件时，逻辑层绑定该事件的处理函数会收到一个事件对象。</p>
</blockquote>
<h4 id="1-BaseEvent-基础事件对象属性列表"><a href="#1-BaseEvent-基础事件对象属性列表" class="headerlink" title="1) BaseEvent 基础事件对象属性列表"></a>1) <strong>BaseEvent 基础事件对象属性列表</strong></h4><blockquote>
<ol>
<li>表格:</li>
</ol>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">说明</th>
<th align="left">基础库版本</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#type">type</a></td>
<td align="left">String</td>
<td align="left">代表事件的类型</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#timeStamp">timeStamp</a></td>
<td align="left">Integer</td>
<td align="left">事件生成时的时间戳–页面打开到触发事件所经过的毫秒数</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#target">target</a></td>
<td align="left">Object</td>
<td align="left">触发事件的组件的一些属性值集合–触发事件的源组件</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#currenttarget">currentTarget</a></td>
<td align="left">Object</td>
<td align="left">当前组件的一些属性值集合–事件绑定的当前组件</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#mark">mark</a></td>
<td align="left">Object</td>
<td align="left">事件标记数据</td>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.7.1</a></td>
</tr>
</tbody></table>
<ol start="2">
<li><p>补充说明</p>
</li>
<li><p>target</p>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">id</td>
<td align="left">String</td>
<td align="left">事件源组件的id</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#dataset">dataset</a></td>
<td align="left">Object</td>
<td align="left">事件源组件上由<code>data-</code>开头的自定义属性组成的集合</td>
</tr>
</tbody></table>
</li>
<li><p>currentTarget</p>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">id</td>
<td align="left">String</td>
<td align="left">当前组件的id</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#dataset">dataset</a></td>
<td align="left">Object</td>
<td align="left">当前组件上由<code>data-</code>开头的自定义属性组成的集合</td>
</tr>
</tbody></table>
<p><code>说明</code>： target 和 currentTarget 可以参考上例中，点击 inner view 时，<code>handleTap3</code> 收到的事件对象 target 和 currentTarget 都是 inner，而 <code>handleTap2</code> 收到的事件对象 target 就是 inner，currentTarget 就是 middle</p>
</li>
</ol>
</blockquote>
<h4 id="2-TouchEvent-触摸事件对象属性列表（继承-BaseEvent）："><a href="#2-TouchEvent-触摸事件对象属性列表（继承-BaseEvent）：" class="headerlink" title="2) TouchEvent 触摸事件对象属性列表（继承 BaseEvent）："></a>2) <strong>TouchEvent 触摸事件对象属性列表（继承 BaseEvent）：</strong></h4><blockquote>
<ol>
<li>表格:</li>
</ol>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#touches">touches</a></td>
<td align="left">Array</td>
<td align="left">触摸事件，当前停留在屏幕中的触摸点信息的数组</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#changedTouches">changedTouches</a></td>
<td align="left">Array</td>
<td align="left">触摸事件，当前变化的触摸点信息的数组</td>
</tr>
</tbody></table>
<ol start="2">
<li><p>补充说明</p>
</li>
<li><p>touches</p>
<p>touches 是一个数组，每个元素为一个 Touch 对象（canvas 触摸事件中携带的 touches 是 CanvasTouch 数组）。 表示当前停留在屏幕上的触摸点。</p>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left">identifier</td>
<td align="left">Number</td>
<td align="left">触摸点的标识符</td>
</tr>
<tr>
<td align="left">pageX, pageY</td>
<td align="left">Number</td>
<td align="left">距离文档左上角的距离，文档的左上角为原点 ，横向为X轴，纵向为Y轴</td>
</tr>
<tr>
<td align="left">clientX, clientY</td>
<td align="left">Number</td>
<td align="left">距离页面可显示区域（屏幕除去导航条）左上角距离，横向为X轴，纵向为Y轴</td>
</tr>
</tbody></table>
</li>
<li><p>changedTouches</p>
<p>changedTouches 数据格式同 touches。 表示有变化的触摸点，如从无变有（touchstart），位置变化（touchmove），从有变无（touchend、touchcancel）</p>
</li>
</ol>
</blockquote>
<h4 id="3-CustomEvent-自定义事件对象属性列表（继承-BaseEvent）："><a href="#3-CustomEvent-自定义事件对象属性列表（继承-BaseEvent）：" class="headerlink" title="3) CustomEvent 自定义事件对象属性列表（继承 BaseEvent）："></a>3) <strong>CustomEvent 自定义事件对象属性列表（继承 BaseEvent）：</strong></h4><blockquote>
<ol>
<li>表格</li>
</ol>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html#detail">detail</a></td>
<td align="left">Object</td>
<td align="left">额外的信息<br>自定义事件所携带的数据，如表单组件的提交事件会携带用户的输入，媒体的错误事件会携带错误信息，详见<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component">组件</a>定义中各个事件的定义。</td>
</tr>
</tbody></table>
</blockquote>
<hr>
<h1 id="五、逻辑层详解"><a href="#五、逻辑层详解" class="headerlink" title="五、逻辑层详解"></a>五、逻辑层详解</h1><blockquote>
<ol>
<li>原理:小程序开发框架的逻辑层使用 <code>JavaScript</code> 引擎为小程序提供开发者 <code>JavaScript</code> 代码的运行环境以及微信小程序的特有功能。</li>
</ol>
<p>  ​	逻辑层将数据进行处理后发送给视图层，同时接受视图层的事件反馈。</p>
<p>  ​	开发者写的所有代码最终将会打包成一份 <code>JavaScript</code> 文件，并在小程序启动的时候运行，直到小程序销毁。这一行为类似<a target="_blank" rel="noopener" href="https://developer.mozilla.org/en-US/docs/Web/API/Service_Worker_API">ServiceWorker</a>，所以逻辑层也称之为 App Service。</p>
<ol start="2">
<li>在 <code>JavaScript</code> 的基础上，我们增加了一些功能，以方便小程序的开发：</li>
</ol>
<ul>
<li>增加 <code>App</code> 和 <code>Page</code> 方法，进行<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/app.html">程序注册</a>和<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/page.html">页面注册</a>。</li>
<li>增加 <code>getApp</code> 和 <code>getCurrentPages</code> 方法，分别用来获取 <code>App</code> 实例和当前页面栈。</li>
<li>提供丰富的 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/api.html">API</a>，如微信用户数据，扫一扫，支付等微信特有能力。</li>
<li>提供<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/module.html#%E6%A8%A1%E5%9D%97%E5%8C%96">模块化</a>能力，每个页面有独立的<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/module.html#%E6%96%87%E4%BB%B6%E4%BD%9C%E7%94%A8%E5%9F%9F">作用域</a>。</li>
</ul>
<p><strong>注意：小程序框架的逻辑层并非运行在浏览器中，因此 <code>JavaScript</code> 在 web 中一些能力都无法使用，如 <code>window</code>，<code>document</code> 等。</strong></p>
<p>该部分将<code>截取官方文档</code>并加以注解</p>
</blockquote>
<h2 id="1、页面路由"><a href="#1、页面路由" class="headerlink" title="1、页面路由"></a>1、页面路由</h2><blockquote>
<p>在小程序中所有页面的路由全部由框架进行管理</p>
</blockquote>
<h3 id="Ⅰ-页面栈与路由方式"><a href="#Ⅰ-页面栈与路由方式" class="headerlink" title="Ⅰ-页面栈与路由方式"></a>Ⅰ-页面栈与路由方式</h3><blockquote>
<ol>
<li>框架以<code>栈</code>的形式维护了当前的所有页面。</li>
<li>对于路由的<code>触发方式</code>以及页面<code>生命周期函数</code>如下：</li>
</ol>
<table>
<thead>
<tr>
<th align="left">路由方式</th>
<th>页面栈表现</th>
<th align="left">触发时机</th>
<th align="left">路由前页面</th>
<th align="left">路由后页面</th>
</tr>
</thead>
<tbody><tr>
<td align="left">初始化</td>
<td>新页面入栈</td>
<td align="left">小程序打开的第一个页面</td>
<td align="left"></td>
<td align="left">onLoad, onShow</td>
</tr>
<tr>
<td align="left">打开新页面</td>
<td>新页面入栈</td>
<td align="left">调用 API <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.navigateTo.html">wx.navigateTo</a> <br>使用组件<navigator open-type="navigateTo"></navigator></td>
<td align="left">onHide</td>
<td align="left">onLoad, onShow</td>
</tr>
<tr>
<td align="left">页面重定向</td>
<td>当前页面出栈，新页面入栈</td>
<td align="left">调用 API <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.redirectTo.html">wx.redirectTo</a> <br>使用组件<navigator open-type="redirectTo"></navigator></td>
<td align="left">onUnload</td>
<td align="left">onLoad, onShow</td>
</tr>
<tr>
<td align="left">页面返回</td>
<td>页面不断出栈，直到目标返回页</td>
<td align="left">调用 API <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.navigateBack.html">wx.navigateBack</a> <br>使用组件<navigator open-type="navigateBack"> <br>用户按左上角返回按钮</navigator></td>
<td align="left">onUnload</td>
<td align="left">onShow</td>
</tr>
<tr>
<td align="left">Tab 切换</td>
<td>页面全部出栈，只留下新的 Tab 页面<br>如果从没有<code>tabBar</code>的页面跳转至有<code>tabBar</code>的页面就<code>一定要用这个</code>,而不是上面的,否则会报错</td>
<td align="left">调用 API <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.switchTab.html">wx.switchTab</a> <br>使用组件<navigator open-type="switchTab"><br>用户切换 Tab</navigator></td>
<td align="left"></td>
<td align="left">各种情况请参考下表</td>
</tr>
<tr>
<td align="left">重启动</td>
<td>页面全部出栈，只留下新的页面</td>
<td align="left">调用 API <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.reLaunch.html">wx.reLaunch</a> <br>使用组件<navigator open-type="reLaunch"></navigator></td>
<td align="left">onUnload</td>
<td align="left">onLoad, onShow</td>
</tr>
</tbody></table>
<ol start="2">
<li>代码示例:</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx">wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//当前页面被隐藏，缓存在栈中，最多存放10个页面</span>
url<span class="token punctuation">:</span> <span class="token string">"/pages/posts/post"</span> <span class="token comment" spellcheck="true">//跳转的页面路径</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
 wx<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//当前页面被销毁</span>
url<span class="token punctuation">:</span> <span class="token string">"/pages/posts/post"</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>Tab 切换对应的生命周期（以 A、B 页面为 Tabbar 页面，C 是从 A 页面打开的页面，D 页面是从 C 页面打开的页面为例）：</li>
</ol>
<table>
<thead>
<tr>
<th align="left">当前页面</th>
<th align="left">路由后页面</th>
<th align="left">触发的生命周期（按顺序）</th>
</tr>
</thead>
<tbody><tr>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">Nothing happend</td>
</tr>
<tr>
<td align="left">A</td>
<td align="left">B</td>
<td align="left">A.onHide(), B.onLoad(), B.onShow()</td>
</tr>
<tr>
<td align="left">A</td>
<td align="left">B（再次打开）</td>
<td align="left">A.onHide(), B.onShow()</td>
</tr>
<tr>
<td align="left">C</td>
<td align="left">A</td>
<td align="left">C.onUnload(), A.onShow()</td>
</tr>
<tr>
<td align="left">C</td>
<td align="left">B</td>
<td align="left">C.onUnload(), B.onLoad(), B.onShow()</td>
</tr>
<tr>
<td align="left">D</td>
<td align="left">B</td>
<td align="left">D.onUnload(), C.onUnload(), B.onLoad(), B.onShow()</td>
</tr>
<tr>
<td align="left">D（从转发进入）</td>
<td align="left">A</td>
<td align="left">D.onUnload(), A.onLoad(), A.onShow()</td>
</tr>
<tr>
<td align="left">D（从转发进入）</td>
<td align="left">B</td>
<td align="left">D.onUnload(), B.onLoad(), B.onShow()</td>
</tr>
</tbody></table>
</blockquote>
<h3 id="Ⅱ-Tips"><a href="#Ⅱ-Tips" class="headerlink" title="Ⅱ-Tips"></a>Ⅱ-Tips</h3><blockquote>
<ul>
<li><code>navigateTo</code>, <code>redirectTo</code> 只能打开非 tabBar 页面。</li>
<li><code>switchTab</code> 只能打开 tabBar 页面。</li>
<li><code>reLaunch</code> 可以打开任意页面。</li>
<li>页面底部的 tabBar 由页面决定，即只要是定义为 tabBar 的页面，底部都有 tabBar。</li>
<li>调用页面路由带的参数可以在目标页面的<code>onLoad</code>中获取。</li>
<li><code>注意</code>:开发者可以使用 <code>getCurrentPages()</code> 函数获取当前页面栈</li>
<li>页面栈中最多存在<code>10</code>个</li>
</ul>
</blockquote>
<h2 id="2、模块化"><a href="#2、模块化" class="headerlink" title="2、模块化"></a>2、模块化</h2><blockquote>
<p>可以将一些公共的代码抽离成为一个单独的 js 文件，作为一个模块。模块只有通过 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/module.html"><code>module.exports</code></a> 或者 <code>exports</code> 才能对外暴露接口。</p>
</blockquote>
<hr>
<h1 id="六、组件与组件库"><a href="#六、组件与组件库" class="headerlink" title="六、组件与组件库"></a>六、组件与组件库</h1><h2 id="1、官方组件"><a href="#1、官方组件" class="headerlink" title="1、官方组件"></a>1、官方组件</h2><blockquote>
<p>重点举例⼩程序中常⽤的布局组件 view,tex 等,现只举例部分,之后遇到觉得需要mark再写入,大部分可以看<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/">官方文档组件部分</a>,便不太多赘述</p>
</blockquote>
<h3 id="Ⅰ-view"><a href="#Ⅰ-view" class="headerlink" title="Ⅰ-view"></a>Ⅰ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/view.html">view</a></h3><blockquote>
<ol>
<li>在小程序中,通常使用<code>&lt;view/&gt;</code>代替<code>&lt;div/&gt;</code>作为容器来做布局</li>
</ol>
<pre class="line-numbers language-xml"><code class="language-xml"><span class="token comment" spellcheck="true">&lt;!--pages/welcome/welcome.wxml--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/测试头像图片.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">></span></span>Hello,洪jl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
  <span class="token comment" spellcheck="true">&lt;!-- &lt;button>开启小程序之旅&lt;/button> --></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">></span></span>开启小程序之旅<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅱ-text"><a href="#Ⅱ-text" class="headerlink" title="Ⅱ-text"></a>Ⅱ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/text.html">text</a></h3><blockquote>
<ol>
<li><p>⽂本标签 </p>
</li>
<li><p>只能嵌套text </p>
</li>
<li><p>⻓按⽂字可以复制（只有该标签有这个功能）–&gt;selectable</p>
</li>
<li><p>可以对如: <code>空格回车&amp;nbsp;</code> 进⾏编码  –&gt;decode</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>selectable</td>
<td>Boolean</td>
<td>false</td>
<td>⽂本是否可选</td>
</tr>
<tr>
<td>decode</td>
<td>Boolean</td>
<td>false</td>
<td>是否解码</td>
</tr>
</tbody></table>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">selectable</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{false}}<span class="token punctuation">"</span></span> <span class="token attr-name">decode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{false}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
   普<span class="token entity" title="&nbsp;">&amp;nbsp;</span>通
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅲ-image"><a href="#Ⅲ-image" class="headerlink" title="Ⅲ-image"></a>Ⅲ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/image.html">image</a></h3><blockquote>
<ol>
<li><p>图⽚标签，image组件<code>默认</code>宽度320px、⾼度240px,所以如果不进行宽高设置,不会进行自适应</p>
</li>
<li><p>⽀持懒加载</p>
</li>
</ol>
<table>
<thead>
<tr>
<th>属性名</th>
<th>类型</th>
<th>默认值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>src</td>
<td>String</td>
<td></td>
<td>图⽚资源地址</td>
</tr>
<tr>
<td>mode</td>
<td>String</td>
<td><code>scaleToFill</code></td>
<td>图⽚裁剪、缩放的模式</td>
</tr>
<tr>
<td>lazy-load</td>
<td>Boolean</td>
<td>false</td>
<td>图⽚懒加载</td>
</tr>
</tbody></table>
<ol start="3">
<li><code>mode</code>模式列举:</li>
</ol>
<table>
<thead>
<tr>
<th>模式</th>
<th>值</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>缩放</td>
<td>scaleToFill</td>
<td>不保持纵横⽐缩放图⽚，使图⽚的宽⾼完全拉伸⾄填满image 元素</td>
</tr>
<tr>
<td>缩放</td>
<td>aspectFit</td>
<td>保持纵横⽐缩放图⽚，使图⽚的⻓边能完全显⽰出来。</td>
</tr>
<tr>
<td>缩放</td>
<td>aspectFill</td>
<td>保持纵横⽐缩放图⽚，只保证图⽚的短边能完全显⽰出来</td>
</tr>
<tr>
<td>缩放</td>
<td>widthFix</td>
<td>宽度不变，⾼度⾃动变化，保持原图宽⾼⽐不变</td>
</tr>
<tr>
<td>裁剪</td>
<td>top</td>
<td>不缩放图⽚，只显⽰图⽚的顶部区域</td>
</tr>
<tr>
<td>裁剪</td>
<td>bottom</td>
<td>不缩放图⽚，只显⽰图⽚的底部区域</td>
</tr>
<tr>
<td>裁剪</td>
<td>center</td>
<td>不缩放图⽚，只显⽰图⽚的中间区域</td>
</tr>
<tr>
<td>裁剪</td>
<td>left</td>
<td>不缩放图⽚，只显⽰图⽚的左边区域</td>
</tr>
<tr>
<td>裁剪</td>
<td>right</td>
<td>不缩放图⽚，只显⽰图⽚的右边区域</td>
</tr>
<tr>
<td>裁剪</td>
<td><code>top left</code>、<code>top right</code><br><code>bottom left</code>、<code>bottom right</code></td>
<td>不缩放图⽚,只显示值所指向区域</td>
</tr>
</tbody></table>
<ol start="4">
<li>代码示例:</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span>  <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>aspectFit<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/测试头像图片.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="5">
<li><p>应用场景举例,简单效果对比</p>
<ol>
<li><p>使用默认mode效果 –&gt;会将图片进行拉伸,导致图片变形</p>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210507145239985.png" alt="image-20210507145239985"></p>
</li>
<li><p>设置为<code>aspectFill</code>效果 –&gt;保持纵横⽐缩放图⽚，只保证图⽚的短边能完全显⽰出来,图片不会变形</p>
<p><img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210507145301242.png" alt="image-20210507145301242"></p>
</li>
<li><p>根据不同的场景选择不同的<code>mode</code>才是最正确的,就如同该截图场景中,<code>aspectFill</code>明显优于默认</p>
</li>
</ol>
</li>
</ol>
</blockquote>
<h3 id="Ⅳ-swiper"><a href="#Ⅳ-swiper" class="headerlink" title="Ⅳ-swiper"></a>Ⅳ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/swiper.html">swiper</a></h3><blockquote>
<p>滑块<code>视图容器</code>。其中只可放置<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/swiper-item.html">swiper-item</a>组件，否则会导致未定义的行为。</p>
<ol>
<li>代码示例</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>pages<span class="token operator">/</span>posts<span class="token operator">/</span>posts<span class="token punctuation">.</span>wxml<span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">></span></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 
    <span class="token comment" spellcheck="true">//1. "false" ==true 普通字符串  </span>
    <span class="token comment" spellcheck="true">//    "{{false}}"==false   {{}}视作运算标记,里面的内容表示表达式 </span>
    <span class="token comment" spellcheck="true">//2. 当你的属性为true时,可以省略value值-- indicator-dots="{{true}}" == indicator-dots</span>
  <span class="token operator">--</span><span class="token operator">></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper</span> <span class="token attr-name">indicator-dots</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{true}}<span class="token punctuation">"</span></span> <span class="token attr-name">autoplay</span> <span class="token attr-name">interval</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>2000<span class="token punctuation">"</span></span> <span class="token attr-name">duration</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>1000<span class="token punctuation">"</span></span> <span class="token attr-name">vertical</span> <span class="token attr-name">circular</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper-item</span><span class="token punctuation">></span></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 插槽 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scaleToFill<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/1.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper-item</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper-item</span><span class="token punctuation">></span></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 插槽 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scaleToFill<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/2.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper-item</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>swiper-item</span><span class="token punctuation">></span></span>
      <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 插槽 <span class="token operator">--</span><span class="token operator">></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>scaleToFill<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/3.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper-item</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>swiper</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>该轮播图代码效果预览: <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/swiper%E4%BB%A3%E7%A0%81%E8%BD%AE%E6%92%AD%E5%9B%BE%E6%95%88%E6%9E%9C%E9%A2%84%E8%A7%88.gif" alt="swiper代码轮播图效果预览"></li>
</ol>
</blockquote>
<h3 id="Ⅴ-scroll-view"><a href="#Ⅴ-scroll-view" class="headerlink" title="Ⅴ-scroll-view"></a>Ⅴ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/scroll-view.html">scroll-view</a></h3><blockquote>
<p>可滚动视图区域。使用竖向滚动时，需要给<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/component/scroll-view.html">scroll-view</a>一个固定高度，通过 WXSS 设置 height。组件属性的长度单位默认为px，<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.4.0</a>起支持传入单位(rpx&#x2F;px)。</p>
<ol>
<li>使用举例图</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210507172539074.png" alt="image-20210507172539074"></p>
</blockquote>
<h2 id="2、LinUi组件库"><a href="#2、LinUi组件库" class="headerlink" title="2、LinUi组件库"></a>2、<a target="_blank" rel="noopener" href="https://doc.mini.talelin.com/">LinUi</a>组件库</h2><h3 id="Ⅰ-安装与使用"><a href="#Ⅰ-安装与使用" class="headerlink" title="Ⅰ-安装与使用"></a>Ⅰ-安装与使用</h3><blockquote>
<ol>
<li><p><code>Lin UI</code> 是基于 <strong>微信小程序原生语法</strong> 实现的组件库。遵循简洁，易用的设计规范。</p>
</li>
<li><p>与其他组件库不同的是，除了提供基本的组件外，还会提供 <code>wxs模块</code> 、<code>高级组件</code> 、 <code>电商组件模块</code> 等等。 例如，在电商项目里常用的 <code>SKU联动选择</code> ，<code>城市选择器</code> 等</p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://doc.mini.talelin.com/start/"><code>安装</code></a>过程可看官方文档:</p>
</li>
</ol>
<ol>
<li>打开小程序的项目根目录，执行下面的命令（如果使用了云开发，需要进入miniprogram文件夹下执行下面的命令）</li>
</ol>
<pre class="line-numbers language-sh"><code class="language-sh">npm init
/*注意事项
1.执行npm init进行初始化，此时会生成一个package.json文件，如果不进行npm init，在构建npm的时候会报一个错误：没有找到 node_modules 目录
2.不建议使用cnpm，这样会带来一些未知的错误。如果网络情况不佳，可以使用下面的命令行更换为淘宝源。
npm config set registry https://registry.npm.taobao.org */
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p> 2)继续执行下面的命令</p>
<pre class="line-numbers language-sh"><code class="language-sh">npm install lin-ui
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<ol start="4">
<li>安装完成后在小程序需要点击<code>工具</code>–&gt;<code>构建 npm</code>才可以使用(<code>所有npm引入的都需要这一步</code>)</li>
<li>要使用<code>自定义组件</code>的话,需要在<code>配置.json</code>文件中(可以在全局的也可以在页面的,作用域不同)注册,具体实现看下面示例</li>
</ol>
</blockquote>
<h3 id="Ⅱ-avatar头像"><a href="#Ⅱ-avatar头像" class="headerlink" title="Ⅱ-avatar头像"></a>Ⅱ-<a target="_blank" rel="noopener" href="https://doc.mini.talelin.com/component/view/avatar.html">avatar</a>头像</h3><blockquote>
<ol>
<li>要使用<code>自定义组件</code>的话,需要在当前page页面.json文件中注册</li>
</ol>
<pre class="line-numbers language-json"><code class="language-json">//page.json
<span class="token punctuation">{</span>
  <span class="token property">"usingComponents"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"l-avatar"</span><span class="token operator">:</span><span class="token string">"/miniprogram_npm/lin-ui/avatar/index"</span><span class="token punctuation">,</span>
     <span class="token property">"组件名(可以自取,一般如果是linui,就l-xxx)"</span><span class="token operator">:</span><span class="token string">"构建后的路径--要具体到那个文件夹下的js"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>使用:</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>pages<span class="token operator">/</span>welcome<span class="token operator">/</span>welcome<span class="token punctuation">.</span>wxml<span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
  <span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>avatar<span class="token punctuation">"</span></span> <span class="token attr-name">lazy-load</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>true<span class="token punctuation">"</span></span> <span class="token attr-name">mode</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>aspectFit<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/测试头像图片.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span> <span class="token operator">--</span><span class="token operator">></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-avatar</span> 
 <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>l-avatar<span class="token punctuation">"</span></span>
 <span class="token attr-name">placement</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>bottom<span class="token punctuation">"</span></span> 
 <span class="token attr-name">open-data</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{[<span class="token punctuation">'</span>userAvatarUrl<span class="token punctuation">'</span>,<span class="token punctuation">'</span>userNickName<span class="token punctuation">'</span>]}}<span class="token punctuation">"</span></span>
 <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>200<span class="token punctuation">"</span></span>
 <span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">></span></span>

<span class="token comment" spellcheck="true">/* pages/welcome/welcome.wxss */</span>
<span class="token comment" spellcheck="true">//可以自己写样式类,加到组件上</span>
<span class="token punctuation">.</span>l<span class="token operator">-</span>avatar<span class="token punctuation">{</span>
  margin<span class="token operator">-</span>top<span class="token punctuation">:</span> 160rpx<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅲ-icon"><a href="#Ⅲ-icon" class="headerlink" title="Ⅲ-icon"></a>Ⅲ-icon</h3><blockquote>
<ol>
<li>在当前page页面.json文件中注册</li>
</ol>
<pre class="line-numbers language-json"><code class="language-json"><span class="token punctuation">{</span>
  <span class="token property">"usingComponents"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"l-icon"</span><span class="token operator">:</span><span class="token string">"/miniprogram_npm/lin-ui/icon/index"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>使用</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>20<span class="token punctuation">"</span></span> <span class="token attr-name">color</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>#34bfa3<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>cart<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>l-icon</span><span class="token punctuation">></span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>l-icon</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>research<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>l-icon</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h1 id="七、小程序API"><a href="#七、小程序API" class="headerlink" title="七、小程序API"></a>七、小程序<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/">API</a></h1><h2 id="1、数据缓存"><a href="#1、数据缓存" class="headerlink" title="1、数据缓存"></a>1、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/storage/wx.setStorageSync.html">数据缓存</a></h2><blockquote>
<p>类似于网页的<code>localStorage</code></p>
<p>官方文档很详细,此处给出具体地址,翻阅文档即可</p>
</blockquote>
<h2 id="2、交互"><a href="#2、交互" class="headerlink" title="2、交互"></a>2、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/ui/interaction/wx.showToast.html">交互</a></h2><blockquote>
<p>一些微信官方给出的组件,具体参数解释看文档,以下给出学习过程中代码示例</p>
</blockquote>
<h3 id="Ⅰ-wx-showToast与wx-showModal"><a href="#Ⅰ-wx-showToast与wx-showModal" class="headerlink" title="Ⅰ-wx.showToast与wx.showModal"></a>Ⅰ-wx.showToast与wx.showModal</h3><blockquote>
<ol>
<li><code>wx.showToast</code>代码示例:</li>
</ol>
<pre class="line-numbers language-js"><code class="language-js">  wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">//此处其实已经被修改完状态,才开始提示,所以要反过来</span>
      title<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected <span class="token operator">?</span> <span class="token string">'收藏成功'</span> <span class="token punctuation">:</span> <span class="token string">'取消收藏'</span><span class="token punctuation">,</span>
      duration<span class="token punctuation">:</span> <span class="token number">1000</span>
   <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li><code>wx.showModal</code>代码示例:</li>
</ol>
<pre class="line-numbers language-js"><code class="language-js">  <span class="token keyword">async</span> <span class="token function">onCollect</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token punctuation">:</span>  <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected <span class="token operator">?</span> <span class="token string">'进行收藏'</span> <span class="token punctuation">:</span> <span class="token string">'取消收藏'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">//点击取消退出</span>
     <span class="token operator">...</span><span class="token operator">...</span><span class="token punctuation">.</span><span class="token comment" spellcheck="true">//点击确认后运行的代码</span>
      wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">//此处其实已经被修改完状态,才开始提示,所以要反过来</span>
      title<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected <span class="token operator">?</span> <span class="token string">'收藏成功'</span> <span class="token punctuation">:</span> <span class="token string">'取消收藏'</span><span class="token punctuation">,</span>
      duration<span class="token punctuation">:</span> <span class="token number">1000</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="3">
<li>运行效果示例(两者并存的效果): <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/showToas%E4%B8%8EshowModal%E8%BF%90%E8%A1%8C%E6%95%88%E6%9E%9C%E5%9B%BE.gif" alt="showToas与showModal运行效果图"></li>
</ol>
</blockquote>
<h2 id="3、媒体"><a href="#3、媒体" class="headerlink" title="3、媒体"></a>3、媒体</h2><h3 id="Ⅰ-媒体音乐播放"><a href="#Ⅰ-媒体音乐播放" class="headerlink" title="Ⅰ-媒体音乐播放"></a>Ⅰ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/media/background-audio/BackgroundAudioManager.html">媒体音乐播放</a></h3><blockquote>
<ol>
<li><p>wx.getBackgroundAudioManager–播放音乐</p>
</li>
<li><p>代码示例</p>
</li>
</ol>
<pre class="line-numbers language-js"><code class="language-js"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">//此处keyi </span>
onLoad<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> mgr <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getBackgroundAudioManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_mgr <span class="token operator">=</span> mgr
    <span class="token comment" spellcheck="true">// if(app.gIsPlayMusic) {  此处进入即默认播放</span>
    <span class="token comment" spellcheck="true">//   mgr.src = this.data.postData.music.url</span>
    <span class="token comment" spellcheck="true">//   mgr.title = this.data.postData.music.title</span>
    <span class="token comment" spellcheck="true">// }</span>

    mgr<span class="token punctuation">.</span><span class="token function">onPlay</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"监听播放"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    mgr<span class="token punctuation">.</span><span class="token function">onPause</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"监听暂停"</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token comment" spellcheck="true">/**
   * 音乐播放
   */</span>
  <span class="token function">onMusic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> mgr <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_mgr
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>isPlaying<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      mgr<span class="token punctuation">.</span><span class="token function">pause</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      app<span class="token punctuation">.</span>gIsPlayMusicId <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span>
    <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">//当前播放状态如果为true则终止(stop())、pause()暂停</span>
    <span class="token keyword">else</span> <span class="token punctuation">{</span>
      mgr<span class="token punctuation">.</span>src <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>postData<span class="token punctuation">.</span>music<span class="token punctuation">.</span>url  <span class="token comment" spellcheck="true">//此处为播放</span>
      mgr<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>postData<span class="token punctuation">.</span>music<span class="token punctuation">.</span>title
      app<span class="token punctuation">.</span>gIsPlayMusicId <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid
    <span class="token punctuation">}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      isPlaying<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>isPlaying
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h3 id="Ⅱ-图片"><a href="#Ⅱ-图片" class="headerlink" title="Ⅱ-图片"></a>Ⅱ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/media/image/wx.saveImageToPhotosAlbum.html">图片</a></h3><h4 id="1-wx-previewImage-Object-object"><a href="#1-wx-previewImage-Object-object" class="headerlink" title="1) wx.previewImage(Object object)"></a>1) <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/media/image/wx.previewImage.html">wx.previewImage(Object object)</a></h4><blockquote>
<p>在新页面中全屏预览图片。预览的过程中用户可以进行保存图片、发送给朋友等操作</p>
<ol>
<li><p>代码示例</p>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>pages<span class="token operator">/</span>movie<span class="token operator">-</span>detail<span class="token operator">/</span>movie<span class="token operator">-</span>detail<span class="token punctuation">.</span>wxml<span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name"><span class="token namespace">catch:</span>tap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onViewPost<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>movie-img<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{movie.images}}<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">// pages/movie-detail/movie-detail.js</span>
<span class="token function">onViewPost</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//相册功能(预览)</span>
    wx<span class="token punctuation">.</span><span class="token function">previewImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      urls<span class="token punctuation">:</span> <span class="token punctuation">[</span>images1<span class="token punctuation">,</span>images2<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
 <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>详见开发文档</p>
</li>
</ol>
</blockquote>
<h2 id="4、界面"><a href="#4、界面" class="headerlink" title="4、界面"></a>4、界面</h2><h3 id="Ⅰ-Tab-Bar"><a href="#Ⅰ-Tab-Bar" class="headerlink" title="Ⅰ-Tab Bar"></a>Ⅰ-<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/app.html">Tab Bar</a></h3><blockquote>
<p>使用时在<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/config.html">app.json</a>中进行配置即可,相关配置详情看全局配置文档,如果需要进行相应操作看官方文档</p>
<pre class="line-numbers language-json"><code class="language-json"><span class="token property">"tabBar"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token property">"selectedColor"</span><span class="token operator">:</span> <span class="token string">"#333333"</span><span class="token punctuation">,</span>
   <span class="token property">"color"</span><span class="token operator">:</span> <span class="token string">"#999999"</span><span class="token punctuation">,</span>
   <span class="token property">"borderStyle"</span><span class="token operator">:</span> <span class="token string">"black"</span><span class="token punctuation">,</span>
   <span class="token property">"position"</span><span class="token operator">:</span> <span class="token string">"top"</span><span class="token punctuation">,</span>
   <span class="token property">"list"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
     <span class="token punctuation">{</span>
       <span class="token property">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/posts/posts"</span><span class="token punctuation">,</span>
       <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"阅读"</span><span class="token punctuation">,</span>
       <span class="token property">"iconPath"</span><span class="token operator">:</span> <span class="token string">"/images/tabBar/yuedu.png"</span><span class="token punctuation">,</span>
       <span class="token property">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"/images/tabBar/yuedu_1.png"</span>
     <span class="token punctuation">}</span><span class="token punctuation">,</span>
     <span class="token punctuation">{</span>
       <span class="token property">"pagePath"</span><span class="token operator">:</span> <span class="token string">"pages/movies/movies"</span><span class="token punctuation">,</span>
       <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"电影"</span><span class="token punctuation">,</span>
       <span class="token property">"iconPath"</span><span class="token operator">:</span> <span class="token string">"/images/tabBar/dianying_1.png"</span><span class="token punctuation">,</span>
       <span class="token property">"selectedIconPath"</span><span class="token operator">:</span> <span class="token string">"/images/tabBar/dianying.png"</span>
     <span class="token punctuation">}</span>
   <span class="token punctuation">]</span>
 <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h1 id="八、小程序生命周期"><a href="#八、小程序生命周期" class="headerlink" title="八、小程序生命周期"></a>八、小程序生命周期</h1><blockquote>
<p>分为<code>应⽤⽣命周期</code>和<code>⻚⾯⽣命周期</code></p>
<p>关于小程序前后台的定义和小程序的运行机制，请参考<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/runtime/operating-mechanism.html">运行机制</a>章节。</p>
</blockquote>
<h2 id="1、应用生命周期"><a href="#1、应用生命周期" class="headerlink" title="1、应用生命周期"></a>1、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html">应用生命周期</a></h2><blockquote>
<ol>
<li>应用生命周期表</li>
</ol>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">必填</th>
<th align="left">说明</th>
<th>场景</th>
<th align="left">最低版本</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onLaunch-Object-object">onLaunch</a></td>
<td align="left">function</td>
<td align="left">否</td>
<td align="left">生命周期回调——监听小程序初始化。</td>
<td>小程序初始化完成时触发，全局只触发一次。参数也可以使用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/life-cycle/wx.getLaunchOptionsSync.html">wx.getLaunchOptionsSync</a> 获取。</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onShow-Object-object">onShow</a></td>
<td align="left">function</td>
<td align="left">否</td>
<td align="left">生命周期回调——监听小程序启动或切前台。</td>
<td>小程序启动，或从后台进入前台显示时触发。也可以使用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onAppShow.html">wx.onAppShow</a> 绑定监听</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onHide">onHide</a></td>
<td align="left">function</td>
<td align="left">否</td>
<td align="left">生命周期回调——监听小程序切后台。</td>
<td>小程序从前台进入后台时触发。也可以使用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onAppHide.html">wx.onAppHide</a> 绑定监听</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onError-String-error">onError</a></td>
<td align="left">function</td>
<td align="left">否</td>
<td align="left">错误监听函数。</td>
<td>小程序发生脚本错误或 API 调用报错时触发。也可以使用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onError.html">wx.onError</a> 绑定监听</td>
<td align="left"></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onPageNotFound-Object-object">onPageNotFound</a></td>
<td align="left">function</td>
<td align="left">否</td>
<td align="left">页面不存在监听函数。</td>
<td>小程序要打开的页面不存在时触发。也可以使用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onPageNotFound.html">wx.onPageNotFound</a> 绑定监听。</td>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.9.90</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onUnhandledRejection-Object-object">onUnhandledRejection</a></td>
<td align="left">function</td>
<td align="left">否</td>
<td align="left">未处理的 Promise 拒绝事件监听函数。</td>
<td>小程序有未处理的 Promise 拒绝时触发。也可以使用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onUnhandledRejection.html">wx.onUnhandledRejection</a> 绑定监听</td>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.10.0</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/App.html#onThemeChange-Object-object">onThemeChange</a></td>
<td align="left">function</td>
<td align="left">否</td>
<td align="left">监听系统主题变化</td>
<td>系统切换主题时触发。也可以使用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/base/app/app-event/wx.onThemeChange.html">wx.onThemeChange</a> 绑定监听</td>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.11.0</a></td>
</tr>
<tr>
<td align="left">其他</td>
<td align="left">any</td>
<td align="left">否</td>
<td align="left">开发者可以添加任意的函数或数据变量到 <code>Object</code> 参数中，用 <code>this</code> 可以访问</td>
<td></td>
<td align="left"></td>
</tr>
</tbody></table>
<ol start="2">
<li>代码示例:</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  onLaunch <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Do something initial when launch.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  onShow <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Do something when show.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  onHide <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Do something when hide.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  onError <span class="token punctuation">(</span>msg<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  globalData<span class="token punctuation">:</span> <span class="token string">'I am global data'</span>
  <span class="token punctuation">,</span>
  <span class="token function">onPageNotFound</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">redirectTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url<span class="token punctuation">:</span> <span class="token string">'pages/...'</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// 如果是 tabbar 页面，请使用 wx.switchTab</span>
  <span class="token punctuation">}</span>
    
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<h2 id="2、页面生命周期"><a href="#2、页面生命周期" class="headerlink" title="2、页面生命周期"></a>2、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html">页面生命周期</a></h2><blockquote>
<ol>
<li>页面生命周期表</li>
</ol>
<table>
<thead>
<tr>
<th align="left">属性</th>
<th align="left">类型</th>
<th align="left">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#data">data</a></td>
<td align="left">Object</td>
<td align="left">页面的初始数据</td>
</tr>
<tr>
<td align="left">options</td>
<td align="left">Object</td>
<td align="left">页面的组件选项，同 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Component.html"><code>Component</code> 构造器</a> 中的 <code>options</code> ，需要基础库版本 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.10.1</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onLoad-Object-query">onLoad</a></td>
<td align="left">function</td>
<td align="left">生命周期回调—监听页面加载</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onShow">onShow</a></td>
<td align="left">function</td>
<td align="left">生命周期回调—监听页面显示</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onReady">onReady</a></td>
<td align="left">function</td>
<td align="left">生命周期回调—监听页面初次渲染完成</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onHide">onHide</a></td>
<td align="left">function</td>
<td align="left">生命周期回调—监听页面隐藏</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onUnload">onUnload</a></td>
<td align="left">function</td>
<td align="left">生命周期回调—监听页面卸载</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onPullDownRefresh">onPullDownRefresh</a></td>
<td align="left">function</td>
<td align="left">监听用户下拉动作</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onReachBottom">onReachBottom</a></td>
<td align="left">function</td>
<td align="left">页面上拉触底事件的处理函数</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onShareAppMessage-Object-object">onShareAppMessage</a></td>
<td align="left">function</td>
<td align="left">用户点击右上角转发</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onShareTimeline">onShareTimeline</a></td>
<td align="left">function</td>
<td align="left">用户点击右上角转发到朋友圈</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onAddToFavorites-Object-object">onAddToFavorites</a></td>
<td align="left">function</td>
<td align="left">用户点击右上角收藏</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onPageScroll-Object-object">onPageScroll</a></td>
<td align="left">function</td>
<td align="left">页面滚动触发事件的处理函数</td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onResize-Object-object">onResize</a></td>
<td align="left">function</td>
<td align="left">页面尺寸改变时触发，详见 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/resizable.html#%E5%9C%A8%E6%89%8B%E6%9C%BA%E4%B8%8A%E5%90%AF%E7%94%A8%E5%B1%8F%E5%B9%95%E6%97%8B%E8%BD%AC%E6%94%AF%E6%8C%81">响应显示区域变化</a></td>
</tr>
<tr>
<td align="left"><a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/Page.html#onTabItemTap-Object-object">onTabItemTap</a></td>
<td align="left">function</td>
<td align="left">当前是 tab 页时，点击 tab 时触发</td>
</tr>
<tr>
<td align="left">其他</td>
<td align="left">any</td>
<td align="left">开发者可以添加任意的函数或数据到 <code>Object</code> 参数中，在页面的函数中用 <code>this</code> 可以访</td>
</tr>
</tbody></table>
<ol start="2">
<li>官方的小程序页面生命周期图:</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/%E5%AE%98%E6%96%B9%E7%9A%84%E5%B0%8F%E7%A8%8B%E5%BA%8F%E9%A1%B5%E9%9D%A2%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F%E5%9B%BE.png" alt="官方的小程序页面生命周期图"></p>
</blockquote>
<h2 id="3、组件生命周期-不算在小程序生命周期中"><a href="#3、组件生命周期-不算在小程序生命周期中" class="headerlink" title="3、组件生命周期-不算在小程序生命周期中"></a>3、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/lifetimes.html">组件生命周期</a>-不算在小程序生命周期中</h2><blockquote>
<p>组件的生命周期，指的是组件自身的一些函数，这些函数在特殊的时间点或遇到一些特殊的框架事件时被自动触发</p>
</blockquote>
<hr>
<h1 id="九、自定义组件"><a href="#九、自定义组件" class="headerlink" title="九、自定义组件"></a>九、<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/">自定义组件</a></h1><blockquote>
<p>开发者可以将页面内的功能模块抽象成自定义组件，以便在不同的页面中重复使用；也可以将复杂的页面拆分成多个低耦合的模块，有助于代码维护。自定义组件在使用时与基础组件非常相似</p>
<p>这部分将截取<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/wxml-wxss.html">文档自定义组件部分</a>中常见的部分进行注解</p>
</blockquote>
<h2 id="1、组件模板和样式"><a href="#1、组件模板和样式" class="headerlink" title="1、组件模板和样式"></a>1、组件模板和样式</h2><blockquote>
<p>类似于页面，自定义组件拥有自己的 <code>wxml</code> 模板和 <code>wxss</code> 样式。</p>
</blockquote>
<h3 id="Ⅰ-组件样式"><a href="#Ⅰ-组件样式" class="headerlink" title="Ⅰ-组件样式"></a>Ⅰ-组件样式</h3><blockquote>
<p>组件对应 <code>wxss</code> 文件的样式，只对组件wxml内的节点生效。编写组件样式时，需要注意以下几点：</p>
<ul>
<li><p>组件和引用组件的页面不能使用id选择器（<code>#a</code>）、属性选择器（<code>[a]</code>）和标签名选择器，请改用class选择器。</p>
</li>
<li><p>组件和引用组件的页面中使用后代选择器（<code>.a .b</code>）在一些极端情况下会有非预期的表现，如遇，请避免使用。</p>
</li>
<li><p>子元素选择器（<code>.a&gt;.b</code>）只能用于 <code>view</code> 组件与其子节点之间，用于其他组件可能导致非预期的情况。</p>
</li>
<li><p>继承样式，如 <code>font</code> 、 <code>color</code> ，会从组件外继承到组件内。</p>
</li>
<li><p>除继承样式外， <code>app.wxss</code> 中的样式、组件所在页面的的样式对自定义组件无效（除非更改组件样式隔离选项）。</p>
</li>
</ul>
<pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token id">#a</span> </span><span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">/* 在组件中不能使用 */</span>
<span class="token selector"><span class="token attribute">[a]</span> </span><span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">/* 在组件中不能使用 */</span>
<span class="token selector">button </span><span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">/* 在组件中不能使用 */</span>
<span class="token selector"><span class="token class">.a</span> > <span class="token class">.b</span> </span><span class="token punctuation">{</span> <span class="token punctuation">}</span> <span class="token comment" spellcheck="true">/* 除非 .a 是 view 组件节点，否则不一定会生效 */</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
<p>除此以外，组件可以指定它所在节点的默认样式，使用 <code>:host</code> 选择器（需要包含基础库 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">1.7.2</a> 或更高版本的开发者工具支持）。</p>
<p>注:此处本人出了一个<code>问题</code>,详见—&gt;本笔记的<code>杂记-&gt;初学者阶段遇到的问题与解决-&gt;Ⅶ</code></p>
</blockquote>
<h3 id="Ⅱ-外部样式类"><a href="#Ⅱ-外部样式类" class="headerlink" title="Ⅱ-外部样式类"></a>Ⅱ-外部样式类</h3><blockquote>
<ol>
<li>有时，组件希望接受外部传入的样式类。此时可以在 <code>Component</code> 中用 <code>externalClasses</code> 定义段定义若干个外部样式类。这个特性可以用于实现类似于 <code>view</code> 组件的 <code>hover-class</code> 属性：页面可以提供一个样式类，赋予 <code>view</code> 的 <code>hover-class</code> ，这个样式类本身写在页面中而非 <code>view</code> 组件的实现中。</li>
</ol>
<p> <strong>注意：在同一个节点上使用普通样式类和外部样式类时，两个类的<code>优先级是未定义</code>的，因此最好避免这种情况。</strong></p>
<ol start="2">
<li><p><strong>代码示例：</strong></p>
<ol>
<li><p>自定义组件部分定义与占位符示例</p>
<pre class="line-numbers language-xaml"><code class="language-xaml">/* 组件 custom-component.js */
Component({
  externalClasses: ['my-class']
})
                                                                  
<!-- 组件 custom-component.wxml 如何引用 -->
<custom-component class="my-class">这段文本的颜色由组件外的 class 决定</custom-component>                                 
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>这样，组件的使用者可以指定这个样式类对应的 class ，就像使用普通属性一样。在 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.7.1</a> 之后，可以指定多个对应的 class 。</p>
</li>
</ol>
</li>
<li><p>外部使用自定义组件并传入样式类</p>
<pre class="line-numbers language-xaml"><code class="language-xaml"><!-- 页面的 WXML -->
<custom-component my-class="red-text" />
<custom-component my-class="large-text" />
<!-- 以下写法需要基础库版本 2.7.1 以上  注意 这只是一个组件传入两个类名,而不是分别创建两个组件-->
<custom-component my-class="red-text large-text" />
                                                                                                              
------------ 样式类声明 页面.wxss ---------------------------------
.red-text {
  color: red;
}
.large-text {
  font-size: 1.5em;
}
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>主要用途:</p>
<ol>
<li><p>如果子组件都是我们自己开发的,而且无所谓改动自定义组件源码,那可以不使用这个</p>
</li>
<li><p>如果自定义组件封装已经足够成熟,不想再动其中样式源码,就可以用外部样式类进行对自定义组件样式改变(使用<code>!important</code>属性能将样式优先级提高),以此进行对于封装好的组件的样式修改,同理可以运用于第三方库</p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token selector"><span class="token class">.movielist</span></span><span class="token punctuation">{</span> //外部样式类
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">25</span>rpx<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#fff</span> <span class="token important">!important</span><span class="token punctuation">;</span>  //此处就可以将这个样式提升到自定义组件样式优先级之上
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ol>
</li>
<li><p>以后如果自己封装自定义组件,就可以向外暴露外部样式类</p>
</li>
</ol>
</blockquote>
<h2 id="2、组件间通信与事件"><a href="#2、组件间通信与事件" class="headerlink" title="2、组件间通信与事件"></a>2、组件间通信与事件</h2><h3 id="Ⅰ-组件间通信"><a href="#Ⅰ-组件间通信" class="headerlink" title="Ⅰ-组件间通信"></a>Ⅰ-组件间通信</h3><blockquote>
<p>组件间的基本通信方式有以下几种。</p>
<ul>
<li>WXML 数据绑定：用于父组件向子组件的指定属性设置数据，仅能设置 JSON 兼容数据（自基础库版本 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/compatibility.html">2.0.9</a> 开始，还可以在数据中包含函数）。具体在 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/wxml-wxss.html">组件模板和样式</a> 章节中介绍。</li>
<li>事件：用于子组件向父组件传递数据，可以传递任意数据。</li>
<li>如果以上两种方式不足以满足需要，父组件还可以通过 <code>this.selectComponent</code> 方法获取子组件实例对象，这样就可以直接访问组件的任意数据和方法。</li>
</ul>
</blockquote>
<h3 id="Ⅱ-触发事件"><a href="#Ⅱ-触发事件" class="headerlink" title="Ⅱ-触发事件"></a>Ⅱ-触发事件</h3><blockquote>
<p>自定义组件触发事件时，需要使用 <code>triggerEvent</code> 方法，指定事件名、detail对象和事件选项</p>
<ol>
<li>官方代码示例</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span> 在自定义组件中 <span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onTap<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>点击这个按钮将触发“myevent”事件<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">//js文件中</span>
<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  properties<span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    onTap<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">var</span> myEventDetail <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// detail对象，提供给事件监听函数</span>
      <span class="token keyword">var</span> myEventOption <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span> <span class="token comment" spellcheck="true">// 触发事件的选项</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">triggerEvent</span><span class="token punctuation">(</span><span class="token string">'myevent'</span><span class="token punctuation">,</span> myEventDetail<span class="token punctuation">,</span> myEventOption<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<ol start="2">
<li>本人在<a target="_blank" rel="noopener" href="https://gitee.com/hongjilin/wechat-applet-demo-source-code"><code>hello小程序</code></a>源码中应用</li>
</ol>
<pre class="line-numbers language-jsx"><code class="language-jsx"><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token operator">--</span>pages<span class="token operator">/</span>posts<span class="token operator">/</span>posts<span class="token punctuation">.</span>wxml<span class="token operator">--</span><span class="token operator">></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{posts}}<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-item</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>item<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>postId<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for-index</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>index<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>post</span> <span class="token attr-name"><span class="token namespace">bind:</span>posttap</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>onGoDetail<span class="token punctuation">"</span></span> <span class="token attr-name">res</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>{{item}}<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">// components/posts/index.js  这是自定义组件</span>

 methods<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    onTap <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">//此处不能用箭头函数,否则`  this.triggerEvent`将会找不到报错</span>
    <span class="token keyword">const</span> pid <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>res<span class="token punctuation">.</span>postId
    <span class="token comment" spellcheck="true">// console.log( this.data)</span>
    <span class="token comment" spellcheck="true">// console.log( this.properties)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">triggerEvent</span><span class="token punctuation">(</span><span class="token string">'posttap'</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
        pid   <span class="token comment" spellcheck="true">//这个参数会在事件调用处获取到</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
 <span class="token punctuation">}</span>

<span class="token comment" spellcheck="true">// pages/posts/posts.js  这个是在调用自定义组件的页面的js中,即可以使用自己的方法,单纯是调用自定义组件定义的事件</span>
  onGoDetail<span class="token punctuation">:</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">//获取组件的自定义属性</span>
    <span class="token comment" spellcheck="true">//先判断,如果e.currentTarget.dataset去得到值,就取有值的 下面这3种写法效果等同</span>
    <span class="token comment" spellcheck="true">//  let pid = (e.currentTarget.dataset.id)?e.currentTarget.dataset.id:e.detail.pid </span>
    <span class="token comment" spellcheck="true">// let pid = e.detail.pid|e.currentTarget.dataset.id  </span>
    <span class="token keyword">let</span> pid <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>pid <span class="token operator">||</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">.</span>id
    wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token punctuation">:</span> <span class="token string">'/pages/post-detail/post-detail?pid='</span> <span class="token operator">+</span> pid<span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</blockquote>
<hr>
<h1 id="杂记"><a href="#杂记" class="headerlink" title="杂记"></a>杂记</h1><blockquote>
<p>体系学习过程笔记外的知识点</p>
</blockquote>
<h2 id="1、微信开发者工具使用技巧"><a href="#1、微信开发者工具使用技巧" class="headerlink" title="1、微信开发者工具使用技巧"></a>1、微信开发者工具使用技巧</h2><h3 id="Ⅰ-新建页面的技巧与规则"><a href="#Ⅰ-新建页面的技巧与规则" class="headerlink" title="Ⅰ-新建页面的技巧与规则:"></a>Ⅰ-新建页面的技巧与规则:</h3><blockquote>
<ol>
<li>本技巧适用于<code>微信开发者工具</code></li>
<li>当你需要新建一个页面时:新建一个page文件目录–&gt;右键<code>新建page</code>–&gt;输入page名字–&gt;一次生成所需四个文件 且自动注册到<code>app.json</code>中</li>
<li>##如果配置文件中出现错误时,自动新建无法成功,更无法自动注册</li>
</ol>
</blockquote>
<h3 id="Ⅱ-指定初始页面"><a href="#Ⅱ-指定初始页面" class="headerlink" title="Ⅱ-指定初始页面"></a>Ⅱ-指定初始页面</h3><blockquote>
<p>当你写多个page时,如果每次通过修改<code>app.json</code>的配置项来指定初始页面,十分麻烦</p>
<ol>
<li><p>可以在<code>app.json</code>用”entryPagePath”:”pages&#x2F;页面文件夹&#x2F;页面文件名” 配置首页,但仍要修改配置文件,十分麻烦</p>
</li>
<li><p>使用编译器的<code>工具栏</code>–&gt;添加<code>编译模式</code>进行指定初始化页面(启动页面默认值要先删除才有提示)</p>
</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210421181759900.png" alt="image-20210421181759900"></p>
<ol start="3">
<li>添加后每次调试只要<code>选择编译模式</code>,就可以切换初始页面</li>
</ol>
</blockquote>
<h3 id="Ⅲ-ctrl-滚轮缩放工具界面"><a href="#Ⅲ-ctrl-滚轮缩放工具界面" class="headerlink" title="Ⅲ-ctrl+滚轮缩放工具界面"></a>Ⅲ-ctrl+滚轮缩放工具界面</h3><blockquote>
<p>只能调成字体了,<code>这个BUG被修复了</code>:dog:<img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210423095423566.png" alt="image-20210423095423566"></p>
</blockquote>
<h2 id="2、微信开发常见编程方法与细节"><a href="#2、微信开发常见编程方法与细节" class="headerlink" title="2、微信开发常见编程方法与细节"></a>2、微信开发常见编程方法与细节</h2><blockquote>
<p>学习、练习、开发微信小程序过程中遇到的一些基础知识与细节记录</p>
</blockquote>
<h3 id="Ⅰ-相对路径规则"><a href="#Ⅰ-相对路径规则" class="headerlink" title="Ⅰ-相对路径规则:"></a>Ⅰ-相对路径规则:</h3><blockquote>
<ol>
<li><p><code>/</code>代表根目录:如引入根目录下的images&#x2F;图片 </p>
<pre class="line-numbers language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>/images/测试头像图片.jpg<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
</li>
<li><p>其余的如:<code>../</code>上一级目录、<code>./</code>同级目录,都与一般无异</p>
</li>
</ol>
</blockquote>
<h3 id="Ⅱ-npm引入第三方库后需进行构建"><a href="#Ⅱ-npm引入第三方库后需进行构建" class="headerlink" title="Ⅱ-npm引入第三方库后需进行构建"></a>Ⅱ-npm引入第三方库后需进行构建</h3><blockquote>
<p>安装第三方库后在小程序需要点击<code>工具</code>–&gt;<code>构建 npm</code>才可以使用</p>
<p><code>所有npm引入的都需要这一步</code></p>
</blockquote>
<h2 id="3、初学阶段遇到的问题与解决"><a href="#3、初学阶段遇到的问题与解决" class="headerlink" title="3、初学阶段遇到的问题与解决"></a>3、初学阶段遇到的问题与解决</h2><blockquote>
<p>这部分将记录本人初学小程序过程遇到的问题,这部分应该大部分是小程序初学者才会遇到的,或者是本人虽然可以直接解决但觉得别人可能会遇到的便记录下来。而后续进阶阶段或者实战开发时遇到的问题,将记录在下面另一章节</p>
</blockquote>
<h3 id="Ⅰ-设置整个page的背景色"><a href="#Ⅰ-设置整个page的背景色" class="headerlink" title="Ⅰ-设置整个page的背景色"></a>Ⅰ-设置整个page的背景色</h3><blockquote>
<ol>
<li><p>问题:当我设置页面背景色时,发现添加背景色的page的高度是被内容撑起而不是全屏?如何解决最简单<br>问题截图 <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210421153332813.png" alt="image-20210421153332813"> 解决后 <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210421153607334.png" alt="image-20210421153607334"></p>
<p>解决:可以在你需要修改的page的样式文件中,给<code>&lt;page/&gt;</code>标签加样式,默认小程序是使用<page>作为最外层的</page></p>
<pre class="line-numbers language-css"><code class="language-css"><span class="token selector">page</span><span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> <span class="token hexcode">#b3d4db</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
</ol>
</blockquote>
<h3 id="Ⅱ-小程序中使用less"><a href="#Ⅱ-小程序中使用less" class="headerlink" title="Ⅱ-小程序中使用less"></a>Ⅱ-小程序中使用less</h3><blockquote>
<p>原⽣⼩程序不⽀持 less ，其他基于⼩程序的框架⼤体都⽀持，如 wepy ， mpvue ， taro 等。 但是仅仅因为⼀个less功能，⽽去引⼊⼀个框架，肯定是不可取的。因此可以⽤以下⽅式来实现</p>
<ol>
<li><p>编辑器是<code>vscode</code></p>
</li>
<li><p>安装插件<code>easy less</code></p>
</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210421151330740.png" alt="image-20210421151330740"></p>
<ol start="3">
<li>在vscode的设置中加⼊如下，配置</li>
</ol>
<pre class="line-numbers language-json"><code class="language-json">  <span class="token property">"less.compile"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"outExt"</span><span class="token operator">:</span> <span class="token string">".wxss"</span>
   <span class="token punctuation">}</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ol start="4">
<li>在要编写样式的地⽅，新建 less ⽂件，如 index.less ,然后正常编辑即可。</li>
</ol>
</blockquote>
<h3 id="Ⅲ-报错-TypeError-wx-getMenuButtonBoundingClientRect-is-not-a-function"><a href="#Ⅲ-报错-TypeError-wx-getMenuButtonBoundingClientRect-is-not-a-function" class="headerlink" title="Ⅲ-报错: TypeError: wx.getMenuButtonBoundingClientRect is not a function"></a>Ⅲ-报错: <code>TypeError: wx.getMenuButtonBoundingClientRect is not a function</code></h3><blockquote>
<p>控制台报错: <code>TypeError: wx.getMenuButtonBoundingClientRect is not a function</code></p>
<p>问题分析:这个 api是 更高版本版本支持的，你的用户有的客户端基础库版本 小于这个基础库。你在小程序后台设置下 最低基础库2.1.0.那样用户客户端基础库版本低于此就会提示升级</p>
<p>解决:<img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/%E6%8A%A5%E9%94%991%E5%9B%BE%E4%BE%8B.png" alt="报错1图例"></p>
</blockquote>
<h3 id="Ⅳ-警告-无效的page-json"><a href="#Ⅳ-警告-无效的page-json" class="headerlink" title="Ⅳ-警告:无效的page.json"></a>Ⅳ-警告:<code>无效的page.json</code></h3><blockquote>
<p>这是初学者才会犯下的错误,但也记录下来</p>
<ol>
<li>问题:在page.json配置文件中与要修改导航栏颜色,却发生报错<br> <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/%E8%AD%A6%E5%91%8Apagejson%E6%97%A0%E6%95%88%E9%97%AE%E9%A2%98.png" alt="警告pagejson无效问题"></li>
<li>解决:修改相应报错配置(<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/configuration/page.html">翻阅文档</a>),虽然响应的属性值相同,但一个外层包裹window,另一个没有包裹<br><img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/%E8%AD%A6%E5%91%8Apagejson%E6%97%A0%E6%95%88%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3.png" alt="警告pagejson无效问题解决.png"></li>
</ol>
</blockquote>
<h3 id="Ⅴ-报错-typeError-Cannot-read-property-39-mark-39-of-undefined"><a href="#Ⅴ-报错-typeError-Cannot-read-property-39-mark-39-of-undefined" class="headerlink" title="Ⅴ-报错:typeError: Cannot read property &#39;mark&#39; of undefined"></a>Ⅴ-报错:<code>typeError: Cannot read property &#39;mark&#39; of undefined</code></h3><blockquote>
<ol>
<li>报错</li>
</ol>
<p> ​	<img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210426170705465.png" alt="image-20210426170705465"></p>
<ol start="2">
<li>解决:最终发现是小程序工具设置问题</li>
</ol>
<p> 需要勾选增强编译</p>
<p> <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210426170827112.png" alt="image-20210426170827112"></p>
</blockquote>
<h3 id="Ⅵ-微信小程序中使用箭头函数导致this指向错误的问题"><a href="#Ⅵ-微信小程序中使用箭头函数导致this指向错误的问题" class="headerlink" title="Ⅵ-微信小程序中使用箭头函数导致this指向错误的问题"></a>Ⅵ-微信小程序中使用箭头函数导致this指向错误的问题</h3><blockquote>
<ol>
<li>问题代码截图:</li>
</ol>
<p><img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210427161221380.png" alt="image-20210427161221380"></p>
<ol start="2">
<li>问题分析:</li>
</ol>
<p>众所周知,箭头函数<code>会改变this指向</code>,当我使用箭头函数后,函数中的this不再指向实例而是指向函数本身,导致data其实是找不到的发生报错</p>
<ol start="3">
<li><p>问题解决:</p>
<ol>
<li><p>不使用箭头函数:</p>
<pre class="line-numbers language-jsx"><code class="language-jsx">   <span class="token keyword">async</span> <span class="token function">onCollect</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token punctuation">:</span>  <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected <span class="token operator">?</span> <span class="token string">'进行收藏'</span> <span class="token punctuation">:</span> <span class="token string">'取消收藏'</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

      <span class="token keyword">let</span> postCollected <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_postCollected <span class="token comment" spellcheck="true">//将当前data中(相当于之前本地缓存的postCollected)拉去下来,防止被覆盖</span>
      postCollected<span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        collected<span class="token punctuation">:</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'posts_collected'</span><span class="token punctuation">,</span> postCollected<span class="token punctuation">)</span>
      wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">//此处其实已经被修改完状态,才开始提示,所以要反过来</span>
        title<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected <span class="token operator">?</span> <span class="token string">'收藏成功'</span> <span class="token punctuation">:</span> <span class="token string">'取消收藏'</span><span class="token punctuation">,</span>
        duration<span class="token punctuation">:</span> <span class="token number">1000</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>使用箭头函数,但需要保存this指向</p>
<pre class="line-numbers language-js"><code class="language-js">  <span class="token keyword">let</span> con  <span class="token comment" spellcheck="true">//用来保存this指向</span>
                                                                              
  <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">//1. 生命周期函数中保存this指向</span>
  onLoad<span class="token punctuation">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>options<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          con<span class="token operator">=</span><span class="token keyword">this</span>  <span class="token comment" spellcheck="true">//用来保存this指向</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment" spellcheck="true">//2. 函数体写法</span>
  onCollect<span class="token punctuation">:</span><span class="token keyword">async</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>  箭头函数写法<span class="token punctuation">,</span>需要保存<span class="token keyword">this</span>指向
     console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>con<span class="token punctuation">)</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token punctuation">:</span>  <span class="token operator">!</span>con<span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected <span class="token operator">?</span> <span class="token string">'进行收藏'</span> <span class="token punctuation">:</span> <span class="token string">'取消收藏'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>result<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
                                                                              
    <span class="token keyword">let</span> postCollected <span class="token operator">=</span> con<span class="token punctuation">.</span>data<span class="token punctuation">.</span>_postCollected <span class="token comment" spellcheck="true">//将当前data中(相当于之前本地缓存的postCollected)拉去下来,防止被覆盖</span>
    postCollected<span class="token punctuation">[</span>con<span class="token punctuation">.</span>data<span class="token punctuation">.</span>_pid<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">!</span>con<span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected
    con<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      collected<span class="token punctuation">:</span> <span class="token operator">!</span>con<span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'posts_collected'</span><span class="token punctuation">,</span> postCollected<span class="token punctuation">)</span>
    wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">//此处其实已经被修改完状态,才开始提示,所以要反过来</span>
      title<span class="token punctuation">:</span> con<span class="token punctuation">.</span>data<span class="token punctuation">.</span>collected <span class="token operator">?</span> <span class="token string">'收藏成功'</span> <span class="token punctuation">:</span> <span class="token string">'取消收藏'</span><span class="token punctuation">,</span>
      duration<span class="token punctuation">:</span> <span class="token number">1000</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
</ol>
</li>
</ol>
</blockquote>
<h3 id="Ⅶ-警告-Some-selectors-are-not-allowed-in-component-wxss-including-tag-name-selectors-ID-selectors-and-attribute-selectors"><a href="#Ⅶ-警告-Some-selectors-are-not-allowed-in-component-wxss-including-tag-name-selectors-ID-selectors-and-attribute-selectors" class="headerlink" title="Ⅶ-警告: Some selectors are not allowed in component wxss, including tag name selectors, ID selectors, and attribute selectors"></a>Ⅶ-警告: <code>Some selectors are not allowed in component wxss, including tag name selectors, ID selectors, and attribute selectors</code></h3><blockquote>
<ol>
<li>出现场景:在我将之前写好的样式模块抽出成<code>自定义组件</code>时,控制台突然出现警告</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210430101549430.png" alt="image-20210430101549430"></p>
<ol start="2">
<li>分析:我使用了<code>属性选择器</code>,而<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/wxml-wxss.html">官方文档在自定义组件部分</a>有要求不能使用,防止出现样式错误,</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210430101700628.png" alt="image-20210430101700628"></p>
<ol start="3">
<li>解决:将属性选择器删除即可</li>
</ol>
</blockquote>
<h3 id="Ⅷ-解决flex布局中-space-between方法的排版问题"><a href="#Ⅷ-解决flex布局中-space-between方法的排版问题" class="headerlink" title="Ⅷ-解决flex布局中 space-between方法的排版问题"></a>Ⅷ-解决flex布局中 space-between方法的排版问题</h3><blockquote>
<p>flex布局 justify-content：space-between； 解决最后一排数量不够自动向两端排列问题</p>
<ol>
<li>问题图示:</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210507095120687.png" alt="image-20210507095120687"></p>
<ol start="2">
<li>分析:flex 布局两端对齐当最后一排数量不够时，会出现以下布局情况</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210507095230974.png" alt="image-20210507095230974"></p>
<ol start="3">
<li>解决方法1:父级添加after伪类法</li>
</ol>
<p>  <img src="/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/image-20210507095349825.png" alt="image-20210507095349825"></p>
<p>  ps:这种解决方案只适合每列有<code>3个</code>的分布情况，如果布局每列有4个，5个,就需要解决方法2</p>
<ol start="4">
<li>解决方法2:使用grid栅格布局,此处不详解,只将解决方案指出,有需要的直接百度搜索<code>使用grid栅格布局</code>即可</li>
</ol>
</blockquote>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        分享
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>扫一扫，分享到微信</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://legendleochen.top/2023/03/04/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%9F%A5%E8%AF%86%E7%82%B9/" alt="微信分享二维码">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/JavaScript/" rel="tag">JavaScript</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Wxml/" rel="tag">Wxml</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Wxss/" rel="tag">Wxss</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/" rel="tag">微信小程序</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2023/03/04/VSCode%E7%BC%96%E8%AF%91%E8%BF%90%E8%A1%8C%E5%92%8C%E8%B0%83%E8%AF%95%E5%A4%9A%E7%A7%8D%E8%AF%AD%E8%A8%80/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            VSCode编译运行和调试多种语言
          
        </div>
      </a>
    
    
      <a href="/2023/03/02/PIC%E5%8D%95%E7%89%87%E6%9C%BA%E2%80%94%E2%80%94%E7%94%B5%E5%8E%8B%E6%A3%80%E6%B5%8B%E5%99%A8/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">PIC单片机——电压检测器</div>
      </a>
    
  </nav>

  
   
  
    
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2023-2024
        <i class="ri-heart-fill heart_icon"></i> LegendLeo Chen
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>访问人数:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>浏览次数:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/mylogo.png" alt="LegendLeo Chen 的空间"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">🚀主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">💾归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">🧭分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">🏷️标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">🛸关于</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/analytics">📊统计</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/secret">🔐秘密</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="搜索">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->
 
<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: ".tocbot",
    contentSelector: ".article-entry",
    headingSelector: "h1, h2, h3, h4, h5, h6",
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: "main",
    positionFixedSelector: ".tocbot",
    positionFixedClass: "is-position-fixed",
    fixedSidebarOffset: "auto",
  });
</script>

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    <div id="music">
    
    
    
    <iframe frameborder="no" border="1" marginwidth="0" marginheight="0" width="200" height="52"
        src="//music.163.com/outchain/player?type=2&id=1491212&auto=1&height=32"></iframe>
</div>

<style>
    #music {
        position: fixed;
        right: 15px;
        bottom: 0;
        z-index: 998;
    }
</style>
    
    

  </div>
  <!-- 背景气泡 -->
  <!--
  <div class="balls-container">
    <div class="balls-particles">
      <span style="--i:11;"></span>
      <span style="--i:12;"></span>
      <span style="--i:24;"></span>
      <span style="--i:10;"></span>
      <span style="--i:14;"></span>
      <span style="--i:23;"></span>
      <span style="--i:18;"></span>
      <span style="--i:16;"></span>
      <span style="--i:19;"></span>
      <span style="--i:20;"></span>
      <span style="--i:22;"></span>
      <span style="--i:25;"></span>
      <span style="--i:18;"></span>
      <span style="--i:21;"></span>
      <span style="--i:13;"></span>
      <span style="--i:15;"></span>
      <span style="--i:26;"></span>
      <span style="--i:17;"></span>
      <span style="--i:13;"></span>
      <span style="--i:26;"></span>
      <span style="--i:28;"></span>
      <span style="--i:11;"></span>
      <span style="--i:12;"></span>
      <span style="--i:24;"></span>
      <span style="--i:10;"></span>
      <span style="--i:14;"></span>
      <span style="--i:23;"></span>
      <span style="--i:18;"></span>
      <span style="--i:16;"></span>
      <span style="--i:19;"></span>
      <span style="--i:20;"></span>
      <span style="--i:22;"></span>
      <span style="--i:25;"></span>
      <span style="--i:18;"></span>
      <span style="--i:21;"></span>
      <span style="--i:13;"></span>
      <span style="--i:15;"></span>
      <span style="--i:26;"></span>
      <span style="--i:17;"></span>
      <span style="--i:13;"></span>
      <span style="--i:26;"></span>
      <span style="--i:28;"></span>
    </div>
  </div>
  <style>
    *
    {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    .balls-container
    { 
      position: fixed;
      top: 0px;
      left: 0px;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      opacity: 0.3;
    }
    
    .balls-particles
    {
      position: fixed;
      display: flex;
      z-index: 3;
      padding: 0 20px;
    }
    
    .balls-particles span
    {
      position: relative;
      bottom: 30px;
      width: 30px;
      height: 30px;
      background-color: #4fc3dc;
      box-shadow: 0 0 0 10px #4fc3dc44,
      0 0 50px #4fc3dc,
      -100px 0 #4fc3dc99,
      100px 0 #ff2d7599;
      margin: 0 4px;
      border-radius: 50%;
      animation: animate 15s ease infinite;
      animation-delay: calc(125s / var(--i));
      transform: translateY(120vh);
    }
    .balls-particles span:nth-child(even) {
      background-color: #ff2d75;
      box-shadow: 0 0 0 10px #ff267544,
      0 0 50px #ff2d75,
      -100px 0 #4fc3dc99,
      100px 0 #4fc3dc99;
      ;
    }
    
    @keyframes animate {
      0%
      {
        transform: translateY(120vh) scale(0) rotate(0deg);
      }
      20%
      {
        transform: translateY(100vh) scale(1) rotate(0deg);
      }
      100%
      {
        transform: translateY(-50vh) scale(0.5) rotate(360deg);
      }
    }
  </style> -->
  <!-- 地月系统 -->
  <!-- <div class="earth-container" >
    <div class="planet"></div>
    <div class="satellite"></div>
   </div>
   <style>
    *{
      padding: 0;
      margin: 0;
      }
      .earth-container {
        width: 36.25em;
        height: 36.25em;
        position: absolute;
        top:5%;
        left: 93%;
        transform: translate(-50%, -50%);
        opacity: 0.3;
      }
      
      .planet{
        width: 15.62*3em;
        height: 15.62*3em;
        background-color: #02c0f5;
        border-radius: 50%;
        position: absolute;
        margin: auto;
        top:0;
        right: 0;
        bottom: 0;
        left: 0;
        z-index: 1;
      }
      
      .planet::before{
        content: '';
        width: 4em;
        height: 4em;
        background-color: #008fd6;
        position: absolute;
        top:10em;
        left: 8em;
        border-radius: 50%; 
        box-shadow: 15em 15em 0 2em #00d68b, 5em 8em 0 3em #10ade1;
      }
      
      .satellite{
        width: 5em;
        height: 5em;
        background-color: #dee517;
        border-radius: 50%;
        position: relative;
        left: -5em;
        bottom: -30em;
        animation: spin 5s infinite;
        z-index: 1;
      }
      
      @keyframes spin {
        49%{
          z-index: 1;
        }
        50%{
          bottom: 3em;
          left: 35em;
          z-index: -1;
        }
        100%{
          z-index: -1;
        }
      }
    </style> -->
<!-- 三角彩带背景 -->
  <canvas id="evanyou-canvas" style="opacity: 0.3; position: fixed; top: 0px; left: 0px; z-index: -1; width: 100%; height: 100%; pointer-events: none;"></canvas>
  <script src="https://cdn.jsdelivr.net/gh/XXXZhy/Blog_Image/js/evanyou_canvas.js"></script>
</body>

</html>